<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="306" skipped="0" tests="522" time="347.099" timestamp="2025-12-07T13:21:51.820536+00:00" hostname="haroon-HP-EliteBook-840-g6"><testcase classname="tests.integration.test_api" name="test_health_endpoint" time="228.325" /><testcase classname="tests.integration.test_api" name="test_graphql_endpoint_exists" time="0.034" /><testcase classname="tests.integration.test_api" name="test_graphql_shop_query" time="0.023" /><testcase classname="tests.integration.test_api" name="test_dashboard_endpoint" time="0.009" /><testcase classname="tests.unit.test_models" name="test_create_user" time="1.609" /><testcase classname="tests.unit.test_models" name="test_create_superuser" time="1.542" /><testcase classname="tests.unit.test_models" name="test_create_category" time="0.015" /><testcase classname="tests.unit.test_models" name="test_create_product_type" time="0.012" /><testcase classname="tests.unit.test_models" name="test_create_product" time="0.018" /><testcase classname="tests.unit.test_models" name="test_site_settings" time="0.012" /><testcase classname="tests.whitebox.test_account_utils.TestIsUserAddressLimitReached" name="test_address_limit_not_reached" time="0.829"><failure message="TypeError: Address() got unexpected keyword arguments: 'user'">tests/whitebox/test_account_utils.py:37: in test_address_limit_not_reached
    Address.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Address() got unexpected keyword arguments: 'user'</failure></testcase><testcase classname="tests.whitebox.test_account_utils.TestIsUserAddressLimitReached" name="test_address_limit_reached" time="0.724"><failure message="TypeError: Address() got unexpected keyword arguments: 'user'">tests/whitebox/test_account_utils.py:59: in test_address_limit_reached
    Address.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Address() got unexpected keyword arguments: 'user'</failure></testcase><testcase classname="tests.whitebox.test_account_utils.TestStoreUserAddress" name="test_store_address_limit_reached" time="0.697"><failure message="TypeError: Address() got unexpected keyword arguments: 'user'">tests/whitebox/test_account_utils.py:89: in test_store_address_limit_reached
    Address.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Address() got unexpected keyword arguments: 'user'</failure></testcase><testcase classname="tests.whitebox.test_account_utils.TestStoreUserAddress" name="test_store_address_existing_address" time="0.689"><failure message="TypeError: Address() got unexpected keyword arguments: 'user'">tests/whitebox/test_account_utils.py:119: in test_store_address_existing_address
    address = Address.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Address() got unexpected keyword arguments: 'user'</failure></testcase><testcase classname="tests.whitebox.test_account_utils.TestStoreUserAddress" name="test_store_address_new_address_billing" time="0.738" /><testcase classname="tests.whitebox.test_account_utils.TestStoreUserAddress" name="test_store_address_new_address_shipping" time="0.733" /><testcase classname="tests.whitebox.test_account_utils.TestStoreUserAddress" name="test_store_address_billing_with_existing_default" time="0.692"><failure message="TypeError: Address() got unexpected keyword arguments: 'user'">tests/whitebox/test_account_utils.py:186: in test_store_address_billing_with_existing_default
    existing = Address.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Address() got unexpected keyword arguments: 'user'</failure></testcase><testcase classname="tests.whitebox.test_account_utils.TestRemoveOldestAddressIfLimitReached" name="test_remove_if_limit_reached" time="0.561"><failure message="TypeError: Address() got unexpected keyword arguments: 'user'">tests/whitebox/test_account_utils.py:232: in test_remove_if_limit_reached
    addr = Address.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Address() got unexpected keyword arguments: 'user'</failure></testcase><testcase classname="tests.whitebox.test_account_utils.TestRemoveOldestAddressIfLimitReached" name="test_remove_if_limit_not_reached" time="0.571"><failure message="TypeError: Address() got unexpected keyword arguments: 'user'">tests/whitebox/test_account_utils.py:257: in test_remove_if_limit_not_reached
    Address.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Address() got unexpected keyword arguments: 'user'</failure></testcase><testcase classname="tests.whitebox.test_account_utils.TestRemoveOldestUserAddress" name="test_remove_oldest_not_default" time="0.564"><failure message="TypeError: Address() got unexpected keyword arguments: 'user'">tests/whitebox/test_account_utils.py:287: in test_remove_oldest_not_default
    oldest = Address.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Address() got unexpected keyword arguments: 'user'</failure></testcase><testcase classname="tests.whitebox.test_account_utils.TestRemoveOldestUserAddress" name="test_remove_oldest_is_default" time="0.565"><failure message="TypeError: Address() got unexpected keyword arguments: 'user'">tests/whitebox/test_account_utils.py:321: in test_remove_oldest_is_default
    oldest = Address.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Address() got unexpected keyword arguments: 'user'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations.TestBaseCheckoutSubtotal" name="test_base_checkout_subtotal_single_line" time="0.023"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'promotion_discount'">tests/whitebox/test_checkout_base_calculations.py:65: in test_base_checkout_subtotal_single_line
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'promotion_discount'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations.TestBaseCheckoutSubtotal" name="test_base_checkout_subtotal_empty_lines" time="0.005" /><testcase classname="tests.whitebox.test_checkout_base_calculations.TestBaseCheckoutSubtotal" name="test_base_checkout_subtotal_include_voucher_false" time="0.013"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'promotion_discount'">tests/whitebox/test_checkout_base_calculations.py:148: in test_base_checkout_subtotal_include_voucher_false
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'promotion_discount'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations.TestCheckoutTotal" name="test_checkout_total_no_discounts" time="0.011" /><testcase classname="tests.whitebox.test_checkout_base_calculations.TestCheckoutTotal" name="test_checkout_total_with_discount" time="0.008" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateBaseLineUnitPrice" name="test_calculate_base_line_unit_price_divides_total_by_quantity" time="0.014"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:76: in test_calculate_base_line_unit_price_divides_total_by_quantity
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateBaseLineTotalPrice" name="test_calculate_base_line_total_price_no_discounts_no_voucher" time="0.013"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:123: in test_calculate_base_line_total_price_no_discounts_no_voucher
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateBaseLineTotalPrice" name="test_calculate_base_line_total_price_with_discounts" time="0.013"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:168: in test_calculate_base_line_total_price_with_discounts
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateBaseLineTotalPrice" name="test_calculate_base_line_total_price_with_voucher_include_true" time="0.013"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:209: in test_calculate_base_line_total_price_with_voucher_include_true
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateBaseLineTotalPrice" name="test_calculate_base_line_total_price_with_voucher_include_false" time="0.013"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:253: in test_calculate_base_line_total_price_with_voucher_include_false
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateUndiscountedBaseLineTotalPrice" name="test_calculate_undiscounted_base_line_total_price" time="0.013"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:300: in test_calculate_undiscounted_base_line_total_price
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateUndiscountedBaseLineUnitPrice" name="test_calculate_undiscounted_base_line_unit_price" time="0.013"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:347: in test_calculate_undiscounted_base_line_unit_price
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestBaseCheckoutDeliveryPrice" name="test_base_checkout_delivery_price_no_shipping_voucher" time="0.007" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestBaseCheckoutDeliveryPrice" name="test_base_checkout_delivery_price_shipping_voucher_include_true" time="0.007" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestBaseCheckoutDeliveryPrice" name="test_base_checkout_delivery_price_shipping_voucher_include_false" time="0.008" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestBaseCheckoutDeliveryPrice" name="test_base_checkout_delivery_price_shipping_voucher_discount_exceeds_price" time="0.007" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestBaseCheckoutUndiscountedDeliveryPrice" name="test_base_checkout_undiscounted_delivery_price_not_shipping_method_info" time="0.007" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestBaseCheckoutUndiscountedDeliveryPrice" name="test_base_checkout_undiscounted_delivery_price_shipping_method_info" time="0.008" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateBasePriceForShippingMethod" name="test_calculate_base_price_no_shipping_method" time="0.010" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateBasePriceForShippingMethod" name="test_calculate_base_price_shipping_not_required" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;shipping_zone_id&quot; of relation &quot;shipping_shippingmethod&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2, Standard, null, 0, , null, {}, {}, null, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (2, Standard, null, 0, , null, {}, {}, null, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_checkout_base_calculations_comprehensive.py:550: in test_calculate_base_price_shipping_not_required
    shipping_method = ShippingMethod.objects.create(name="Standard")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (2, Standard, null, 0, , null, {}, {}, null, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateBasePriceForShippingMethod" name="test_calculate_base_price_shipping_required_with_method" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;shipping_zone_id&quot; of relation &quot;shipping_shippingmethod&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (3, Standard, null, 0, , null, {}, {}, null, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (3, Standard, null, 0, , null, {}, {}, null, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_checkout_base_calculations_comprehensive.py:575: in test_calculate_base_price_shipping_required_with_method
    shipping_method = ShippingMethod.objects.create(name="Standard")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (3, Standard, null, 0, , null, {}, {}, null, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCalculateBasePriceForShippingMethod" name="test_calculate_base_price_uses_lines_for_shipping_required" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;shipping_zone_id&quot; of relation &quot;shipping_shippingmethod&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (4, Standard, null, 0, , null, {}, {}, null, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (4, Standard, null, 0, , null, {}, {}, null, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_checkout_base_calculations_comprehensive.py:601: in test_calculate_base_price_uses_lines_for_shipping_required
    shipping_method = ShippingMethod.objects.create(name="Standard")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (4, Standard, null, 0, , null, {}, {}, null, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestBaseCheckoutTotal" name="test_base_checkout_total_sums_subtotal_and_shipping" time="0.010" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestBaseCheckoutSubtotal" name="test_base_checkout_subtotal_empty_lines" time="0.005" /><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestBaseCheckoutSubtotal" name="test_base_checkout_subtotal_multiple_lines" time="0.015"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:698: in test_base_checkout_subtotal_multiple_lines
    line_info1 = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestCheckoutTotal" name="test_checkout_total_calculates_with_gift_cards" time="0.008"><failure message="AttributeError: &lt;module 'saleor.checkout.base_calculations' from '/home/haroon/SQE/SQE_Project_Saleor/saleor/checkout/base_calculations.py'&gt; does not have the attribute 'calculate_checkout_total_with_gift_cards'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:753: in test_checkout_total_calculates_with_gift_cards
    with patch('saleor.checkout.base_calculations.calculate_checkout_total_with_gift_cards') as mock_calc:
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: &lt;module 'saleor.checkout.base_calculations' from '/home/haroon/SQE/SQE_Project_Saleor/saleor/checkout/base_calculations.py'&gt; does not have the attribute 'calculate_checkout_total_with_gift_cards'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestGetLineTotalPriceWithPropagatedCheckoutDiscount" name="test_get_line_total_price_finds_line" time="0.015"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:792: in test_get_line_total_price_finds_line
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestGetLineTotalPriceWithPropagatedCheckoutDiscount" name="test_get_line_total_price_line_not_found" time="0.015"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:846: in test_get_line_total_price_line_not_found
    line_info1 = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestPropagateCheckoutDiscountOnCheckoutLinesPrices" name="test_propagate_checkout_discount_single_line" time="0.014"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:911: in test_propagate_checkout_discount_single_line
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_comprehensive.TestPropagateCheckoutDiscountOnCheckoutLinesPrices" name="test_propagate_checkout_discount_multiple_lines" time="0.014"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_base_calculations_comprehensive.py:965: in test_propagate_checkout_discount_multiple_lines
    line_info1 = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestCalculateBaseLineUnitPrice" name="test_calculate_base_line_unit_price_returns_channel_listing_price" time="0.012"><failure message="TypeError: calculate_base_line_unit_price() takes 1 positional argument but 3 were given">tests/whitebox/test_checkout_base_calculations_extensive.py:67: in test_calculate_base_line_unit_price_returns_channel_listing_price
    result = calculate_base_line_unit_price(line_info, channel, "USD")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: calculate_base_line_unit_price() takes 1 positional argument but 3 were given</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestCalculateBaseLineUnitPrice" name="test_calculate_base_line_unit_price_handles_custom_price" time="0.012"><failure message="TypeError: CheckoutLine() got unexpected keyword arguments: 'price_override_amount'">tests/whitebox/test_checkout_base_calculations_extensive.py:91: in test_calculate_base_line_unit_price_handles_custom_price
    line = CheckoutLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: CheckoutLine() got unexpected keyword arguments: 'price_override_amount'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestCalculateBaseLineTotalPrice" name="test_calculate_base_line_total_price_multiplies_by_quantity" time="0.024"><failure message="TypeError: calculate_base_line_total_price() takes from 1 to 2 positional arguments but 3 were given">tests/whitebox/test_checkout_base_calculations_extensive.py:144: in test_calculate_base_line_total_price_multiplies_by_quantity
    result = calculate_base_line_total_price(line_info, channel, "USD")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: calculate_base_line_total_price() takes from 1 to 2 positional arguments but 3 were given</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestBaseCheckoutDeliveryPrice" name="test_base_checkout_delivery_price_returns_zero_when_no_shipping_method" time="0.009" /><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestBaseCheckoutDeliveryPrice" name="test_base_checkout_delivery_price_returns_shipping_method_price" time="0.016"><failure message="AssertionError: assert Money('0.00', 'USD') == Money('10.00', 'USD')&#10; +  where Money('10.00', 'USD') = Money(Decimal('10.00'), 'USD')&#10; +    where Decimal('10.00') = Decimal('10.00')">tests/whitebox/test_checkout_base_calculations_extensive.py:209: in test_base_checkout_delivery_price_returns_shipping_method_price
    assert result == Money(Decimal("10.00"), "USD")
E   AssertionError: assert Money('0.00', 'USD') == Money('10.00', 'USD')
E    +  where Money('10.00', 'USD') = Money(Decimal('10.00'), 'USD')
E    +    where Decimal('10.00') = Decimal('10.00')</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestBaseCheckoutSubtotal" name="test_base_checkout_subtotal_sums_line_totals" time="0.020" /><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestBaseCheckoutTotal" name="test_base_checkout_total_adds_subtotal_and_shipping" time="0.010"><failure message="TypeError: base_checkout_total() got an unexpected keyword argument 'include_voucher'">tests/whitebox/test_checkout_base_calculations_extensive.py:286: in test_base_checkout_total_adds_subtotal_and_shipping
    result = base_checkout_total(checkout_info, lines_info, include_voucher=False)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: base_checkout_total() got an unexpected keyword argument 'include_voucher'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestCheckoutTotal" name="test_checkout_total_includes_discounts" time="0.009"><failure message="TypeError: checkout_total() got an unexpected keyword argument 'include_voucher'">tests/whitebox/test_checkout_base_calculations_extensive.py:311: in test_checkout_total_includes_discounts
    result = checkout_total(checkout_info, [], include_voucher=False)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: checkout_total() got an unexpected keyword argument 'include_voucher'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestGetLineTotalPriceWithPropagatedCheckoutDiscount" name="test_get_line_total_price_with_propagated_discount_applies_discount" time="0.014"><failure message="TypeError: get_line_total_price_with_propagated_checkout_discount() takes 3 positional arguments but 6 were given">tests/whitebox/test_checkout_base_calculations_extensive.py:356: in test_get_line_total_price_with_propagated_discount_applies_discount
    result = get_line_total_price_with_propagated_checkout_discount(
E   TypeError: get_line_total_price_with_propagated_checkout_discount() takes 3 positional arguments but 6 were given</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestGetLineTotalPriceWithPropagatedCheckoutDiscount" name="test_get_line_total_price_with_propagated_discount_handles_zero_subtotal" time="0.015"><failure message="TypeError: get_line_total_price_with_propagated_checkout_discount() takes 3 positional arguments but 6 were given">tests/whitebox/test_checkout_base_calculations_extensive.py:403: in test_get_line_total_price_with_propagated_discount_handles_zero_subtotal
    result = get_line_total_price_with_propagated_checkout_discount(
E   TypeError: get_line_total_price_with_propagated_checkout_discount() takes 3 positional arguments but 6 were given</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestCalculateBasePriceForShippingMethod" name="test_calculate_base_price_returns_shipping_method_price" time="0.010"><failure message="AttributeError: 'Channel' object has no attribute 'delivery_method'">tests/whitebox/test_checkout_base_calculations_extensive.py:446: in test_calculate_base_price_returns_shipping_method_price
    result = calculate_base_price_for_shipping_method(
saleor/checkout/base_calculations.py:140: in calculate_base_price_for_shipping_method
    shipping_method = shipping_method_info.delivery_method
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'Channel' object has no attribute 'delivery_method'</failure></testcase><testcase classname="tests.whitebox.test_checkout_base_calculations_extensive.TestCalculateBasePriceForShippingMethod" name="test_calculate_base_price_returns_zero_when_no_method" time="0.006"><failure message="AttributeError: 'Channel' object has no attribute 'delivery_method'">tests/whitebox/test_checkout_base_calculations_extensive.py:462: in test_calculate_base_price_returns_zero_when_no_method
    result = calculate_base_price_for_shipping_method(
saleor/checkout/base_calculations.py:140: in calculate_base_price_for_shipping_method
    shipping_method = shipping_method_info.delivery_method
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'Channel' object has no attribute 'delivery_method'</failure></testcase><testcase classname="tests.whitebox.test_checkout_calculations_comprehensive.TestCalculateBaseLineUnitPrice" name="test_calculate_base_line_unit_price_basic" time="0.019"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_calculations_comprehensive.py:78: in test_calculate_base_line_unit_price_basic
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_calculations_comprehensive.TestCalculateBaseLineUnitPrice" name="test_calculate_base_line_unit_price_with_discounts" time="0.017"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_calculations_comprehensive.py:140: in test_calculate_base_line_unit_price_with_discounts
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_calculations_comprehensive.TestCalculateBaseLineTotalPrice" name="test_calculate_base_line_total_price_no_discounts" time="0.017"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_calculations_comprehensive.py:207: in test_calculate_base_line_total_price_no_discounts
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_calculations_comprehensive.TestCalculateBaseLineTotalPrice" name="test_calculate_base_line_total_price_with_discounts" time="0.016"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_calculations_comprehensive.py:268: in test_calculate_base_line_total_price_with_discounts
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_calculations_comprehensive.TestCalculateBaseLineTotalPrice" name="test_calculate_base_line_total_price_include_voucher_false" time="0.016"><failure message="AttributeError: property 'code' of 'Voucher' object has no setter">tests/whitebox/test_checkout_calculations_comprehensive.py:327: in test_calculate_base_line_total_price_include_voucher_false
    voucher = Voucher.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'code' of 'Voucher' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_checkout_calculations_comprehensive.TestCalculateUndiscountedBaseLineTotalPrice" name="test_calculate_undiscounted_base_line_total_price" time="0.016"><failure message="TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'">tests/whitebox/test_checkout_calculations_comprehensive.py:399: in test_calculate_undiscounted_base_line_total_price
    line_info = CheckoutLineInfo(
E   TypeError: CheckoutLineInfo.__init__() got an unexpected keyword argument 'undiscounted_unit_price'</failure></testcase><testcase classname="tests.whitebox.test_checkout_calculations_comprehensive.TestBaseCheckoutDeliveryPrice" name="test_base_checkout_delivery_price_no_voucher" time="0.010"><failure message="AssertionError: assert Decimal('0.00') == Decimal('10.00')&#10; +  where Decimal('0.00') = Money('0.00', 'USD').amount&#10; +  and   Decimal('10.00') = Decimal('10.00')">tests/whitebox/test_checkout_calculations_comprehensive.py:464: in test_base_checkout_delivery_price_no_voucher
    assert delivery_price.amount == Decimal("10.00")
E   AssertionError: assert Decimal('0.00') == Decimal('10.00')
E    +  where Decimal('0.00') = Money('0.00', 'USD').amount
E    +  and   Decimal('10.00') = Decimal('10.00')</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestInvalidateCheckout" name="test_invalidate_checkout_with_recalculate_discount" time="0.014" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestInvalidateCheckout" name="test_invalidate_checkout_without_recalculate_discount" time="0.015" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestInvalidateCheckoutPrices" name="test_invalidate_checkout_prices_with_save" time="0.015" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestInvalidateCheckoutPrices" name="test_invalidate_checkout_prices_without_save" time="0.008" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestCheckVariantInStock" name="test_check_variant_in_stock_replace_mode" time="0.018" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestCheckVariantInStock" name="test_check_variant_in_stock_add_mode" time="0.018" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestCheckVariantInStock" name="test_check_variant_in_stock_no_existing_line" time="0.015" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestCheckVariantInStock" name="test_check_variant_in_stock_negative_quantity_error" time="0.016" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestCheckVariantInStock" name="test_check_variant_in_stock_with_check_quantity" time="0.015" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestAddVariantToCheckout" name="test_add_variant_to_checkout_product_not_published" time="0.014"><failure message="AttributeError: module 'saleor.checkout.utils' has no attribute 'ProductChannelListing'">tests/whitebox/test_checkout_utils_comprehensive.py:318: in test_add_variant_to_checkout_product_not_published
    with patch('saleor.checkout.utils.ProductChannelListing.objects.filter') as mock_filter:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'saleor.checkout.utils' has no attribute 'ProductChannelListing'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestAddVariantToCheckout" name="test_add_variant_to_checkout_force_new_line" time="0.016"><failure message="AttributeError: module 'saleor.checkout.utils' has no attribute 'ProductChannelListing'">tests/whitebox/test_checkout_utils_comprehensive.py:355: in test_add_variant_to_checkout_force_new_line
    with patch('saleor.checkout.utils.ProductChannelListing.objects.filter') as mock_filter:
/usr/lib/python3.12/unittest/mock.py:1442: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/usr/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'saleor.checkout.utils' has no attribute 'ProductChannelListing'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetVoucherDiscountForCheckout" name="test_get_voucher_discount_entire_order_apply_once" time="0.010"><failure message="NameError: name 'Money' is not defined">tests/whitebox/test_checkout_utils_comprehensive.py:406: in test_get_voucher_discount_entire_order_apply_once
    Money(Decimal("10.00"), "USD"),
    ^^^^^
E   NameError: name 'Money' is not defined</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetVoucherDiscountForCheckout" name="test_get_voucher_discount_entire_order_not_apply_once" time="0.010"><failure message="NameError: name 'Money' is not defined">tests/whitebox/test_checkout_utils_comprehensive.py:442: in test_get_voucher_discount_entire_order_not_apply_once
    mock_subtotal.return_value = Money(Decimal("20.00"), "USD")
                                 ^^^^^
E   NameError: name 'Money' is not defined</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetVoucherDiscountForCheckout" name="test_get_voucher_discount_shipping" time="0.009"><failure message="NameError: name 'Money' is not defined">tests/whitebox/test_checkout_utils_comprehensive.py:474: in test_get_voucher_discount_shipping
    mock_shipping.return_value = Money(Decimal("5.00"), "USD")
                                 ^^^^^
E   NameError: name 'Money' is not defined</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetVoucherDiscountForCheckout" name="test_get_voucher_discount_specific_product" time="0.010"><failure message="NameError: name 'Money' is not defined">tests/whitebox/test_checkout_utils_comprehensive.py:505: in test_get_voucher_discount_specific_product
    mock_products.return_value = Money(Decimal("3.00"), "USD")
                                 ^^^^^
E   NameError: name 'Money' is not defined</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetVoucherDiscountForCheckout" name="test_get_voucher_discount_unknown_type" time="0.009" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetVoucherForCheckout" name="test_get_voucher_for_checkout_no_voucher_code" time="0.007" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetVoucherForCheckout" name="test_get_voucher_for_checkout_voucher_code_not_found" time="0.008" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetVoucherForCheckout" name="test_get_voucher_for_checkout_voucher_code_found" time="0.018"><failure message="assert None == &lt;Voucher: Voucher object (5)&gt;">tests/whitebox/test_checkout_utils_comprehensive.py:600: in test_get_voucher_for_checkout_voucher_code_found
    assert voucher_result == voucher
E   assert None == &lt;Voucher: Voucher object (5)&gt;</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetVoucherForCheckout" name="test_get_voucher_for_checkout_usage_increased" time="0.011" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestRecalculateCheckoutDiscount" name="test_recalculate_checkout_discount_with_voucher" time="0.010"><failure message="NameError: name 'Money' is not defined">tests/whitebox/test_checkout_utils_comprehensive.py:659: in test_recalculate_checkout_discount_with_voucher
    mock_check.return_value = Money(Decimal("5.00"), "USD")
                              ^^^^^
E   NameError: name 'Money' is not defined</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestRecalculateCheckoutDiscount" name="test_recalculate_checkout_discount_no_voucher" time="0.009" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestIsShippingRequired" name="test_is_shipping_required_true" time="0.014"><failure message="NameError: name 'Money' is not defined">tests/whitebox/test_checkout_utils_comprehensive.py:736: in test_is_shipping_required_true
    undiscounted_unit_price=Money(Decimal("10.00"), "USD")
                            ^^^^^
E   NameError: name 'Money' is not defined</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestIsShippingRequired" name="test_is_shipping_required_false" time="0.014"><failure message="NameError: name 'Money' is not defined">tests/whitebox/test_checkout_utils_comprehensive.py:778: in test_is_shipping_required_false
    undiscounted_unit_price=Money(Decimal("10.00"), "USD")
                            ^^^^^
E   NameError: name 'Money' is not defined</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestCalculateCheckoutWeight" name="test_calculate_checkout_weight_sums_line_weights" time="0.013"><failure message="django.db.utils.IntegrityError: duplicate key value violates unique constraint &quot;product_producttype_slug_key&quot;&#10;DETAIL:  Key (slug)=() already exists.">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "product_producttype_slug_key"
E   DETAIL:  Key (slug)=() already exists.

The above exception was the direct cause of the following exception:
tests/whitebox/test_checkout_utils_comprehensive.py:809: in test_calculate_checkout_weight_sums_line_weights
    product_type=ProductType.objects.create(name="Type"),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: duplicate key value violates unique constraint "product_producttype_slug_key"
E   DETAIL:  Key (slug)=() already exists.</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetAddressForCheckoutTaxes" name="test_get_address_for_checkout_taxes_uses_shipping_address" time="0.007" /><testcase classname="tests.whitebox.test_checkout_utils_comprehensive.TestGetAddressForCheckoutTaxes" name="test_get_address_for_checkout_taxes_uses_billing_address" time="0.007" /><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestInvalidateCheckout" name="test_invalidate_checkout_sets_should_refresh_prices" time="0.006"><failure message="TypeError: Checkout() got unexpected keyword arguments: 'should_refresh_prices'">tests/whitebox/test_checkout_utils_extensive.py:50: in test_invalidate_checkout_sets_should_refresh_prices
    checkout = Checkout.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Checkout() got unexpected keyword arguments: 'should_refresh_prices'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestInvalidateCheckoutPrices" name="test_invalidate_checkout_prices_sets_flag" time="0.006"><failure message="TypeError: Checkout() got unexpected keyword arguments: 'should_refresh_prices'">tests/whitebox/test_checkout_utils_extensive.py:73: in test_invalidate_checkout_prices_sets_flag
    checkout = Checkout.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Checkout() got unexpected keyword arguments: 'should_refresh_prices'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestCheckoutLinesBulkUpdate" name="test_checkout_lines_bulk_update_updates_lines" time="0.025" /><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestCheckoutLinesBulkDelete" name="test_checkout_lines_bulk_delete_deletes_lines" time="0.023" /><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestDeleteCheckouts" name="test_delete_checkouts_deletes_specified_checkouts" time="0.009"><failure message="AttributeError: 'Checkout' object has no attribute 'id'">tests/whitebox/test_checkout_utils_extensive.py:192: in test_delete_checkouts_deletes_specified_checkouts
    deleted_count = delete_checkouts([checkout1.id])
                                      ^^^^^^^^^^^^
E   AttributeError: 'Checkout' object has no attribute 'id'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestGetUserCheckout" name="test_get_user_checkout_returns_user_checkout" time="0.597"><failure message="AttributeError: 'str' object has no attribute 'filter'">tests/whitebox/test_checkout_utils_extensive.py:217: in test_get_user_checkout_returns_user_checkout
    result = get_user_checkout(user, channel.slug)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/checkout/utils.py:178: in get_user_checkout
    return checkout_queryset.filter(user=user, channel__is_active=True).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'filter'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestGetUserCheckout" name="test_get_user_checkout_returns_none_when_no_checkout" time="0.598"><failure message="AttributeError: 'str' object has no attribute 'filter'">tests/whitebox/test_checkout_utils_extensive.py:230: in test_get_user_checkout_returns_none_when_no_checkout
    result = get_user_checkout(user, channel.slug)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/checkout/utils.py:178: in get_user_checkout
    return checkout_queryset.filter(user=user, channel__is_active=True).first()
           ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'filter'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestCheckVariantInStock" name="test_check_variant_in_stock_returns_true_when_available" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (99520fef-040b-4a1d-8f06-11b2112a24ed, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (99520fef-040b-4a1d-8f06-11b2112a24ed, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_checkout_utils_extensive.py:246: in test_check_variant_in_stock_returns_true_when_available
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (99520fef-040b-4a1d-8f06-11b2112a24ed, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestCheckVariantInStock" name="test_check_variant_in_stock_returns_false_when_not_enough" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (c4ccffb5-25f4-4ec6-9162-5e032145422d, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (c4ccffb5-25f4-4ec6-9162-5e032145422d, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_checkout_utils_extensive.py:277: in test_check_variant_in_stock_returns_false_when_not_enough
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (c4ccffb5-25f4-4ec6-9162-5e032145422d, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestAddVariantToCheckout" name="test_add_variant_to_checkout_creates_new_line" time="0.012"><failure message="AttributeError: 'Checkout' object has no attribute 'checkout'">tests/whitebox/test_checkout_utils_extensive.py:327: in test_add_variant_to_checkout_creates_new_line
    line = add_variant_to_checkout(checkout, variant, 2, channel.slug, "US")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/checkout/utils.py:231: in add_variant_to_checkout
    checkout = checkout_info.checkout
               ^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'Checkout' object has no attribute 'checkout'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestAddVariantToCheckout" name="test_add_variant_to_checkout_increases_existing_line" time="0.012"><failure message="TypeError: add_variant_to_checkout() got multiple values for argument 'replace'">tests/whitebox/test_checkout_utils_extensive.py:359: in test_add_variant_to_checkout_increases_existing_line
    line = add_variant_to_checkout(checkout, variant, 3, channel.slug, "US", replace=False)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: add_variant_to_checkout() got multiple values for argument 'replace'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestCalculateCheckoutQuantity" name="test_calculate_checkout_quantity_sums_line_quantities" time="0.014" /><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestChangeBillingAddressInCheckout" name="test_change_billing_address_sets_billing_address" time="0.008"><failure message="TypeError: change_billing_address_in_checkout() got an unexpected keyword argument 'save'">tests/whitebox/test_checkout_utils_extensive.py:434: in test_change_billing_address_sets_billing_address
    change_billing_address_in_checkout(checkout, address, save=True)
E   TypeError: change_billing_address_in_checkout() got an unexpected keyword argument 'save'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestChangeShippingAddressInCheckout" name="test_change_shipping_address_sets_shipping_address" time="0.011"><failure message="TypeError: change_shipping_address_in_checkout() got an unexpected keyword argument 'save'">tests/whitebox/test_checkout_utils_extensive.py:463: in test_change_shipping_address_sets_shipping_address
    change_shipping_address_in_checkout(checkout, address, save=True)
E   TypeError: change_shipping_address_in_checkout() got an unexpected keyword argument 'save'</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestGetVoucherForCheckout" name="test_get_voucher_for_checkout_returns_voucher_when_code_exists" time="0.008"><failure message="AttributeError: property 'code' of 'Voucher' object has no setter">tests/whitebox/test_checkout_utils_extensive.py:480: in test_get_voucher_for_checkout_returns_voucher_when_code_exists
    voucher = Voucher.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'code' of 'Voucher' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_checkout_utils_extensive.TestGetVoucherForCheckout" name="test_get_voucher_for_checkout_returns_none_when_no_code" time="0.007"><failure message="TypeError: get_voucher_for_checkout() missing 1 required positional argument: 'channel_slug'">tests/whitebox/test_checkout_utils_extensive.py:508: in test_get_voucher_for_checkout_returns_none_when_no_code
    result = get_voucher_for_checkout(checkout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: get_voucher_for_checkout() missing 1 required positional argument: 'channel_slug'</failure></testcase><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_get_value_from_private_metadata_key_exists" time="0.010" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_get_value_from_private_metadata_key_not_exists" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_store_value_in_private_metadata_metadata_exists" time="0.008" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_store_value_in_private_metadata_metadata_none" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_clear_private_metadata" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_delete_value_from_private_metadata_key_exists" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_delete_value_from_private_metadata_key_not_exists" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_get_value_from_metadata_key_exists" time="0.010" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_get_value_from_metadata_key_not_exists" time="0.010" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_store_value_in_metadata_metadata_exists" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_store_value_in_metadata_metadata_none" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_clear_metadata" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_delete_value_from_metadata_key_exists" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataStatementCoverage" name="test_delete_value_from_metadata_key_not_exists" time="0.010" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataDecisionCoverage" name="test_decision_private_metadata_key_in_true" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataDecisionCoverage" name="test_decision_private_metadata_key_in_false" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataDecisionCoverage" name="test_decision_metadata_key_in_true" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestModelWithMetadataDecisionCoverage" name="test_decision_metadata_key_in_false" time="0.009" /><testcase classname="tests.whitebox.test_core_metadata.TestPublishableModelIsVisible" name="test_is_visible_published_true_published_at_none" time="0.008"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_metadata.py:362: in test_is_visible_published_true_published_at_none
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_metadata.TestPublishableModelIsVisible" name="test_is_visible_published_true_published_at_past" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_metadata.py:380: in test_is_visible_published_true_published_at_past
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_metadata.TestPublishableModelIsVisible" name="test_is_visible_published_true_published_at_future" time="0.008"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_metadata.py:398: in test_is_visible_published_true_published_at_future
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_metadata.TestPublishableModelIsVisible" name="test_is_visible_published_false" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_metadata.py:416: in test_is_visible_published_false
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelStatementCoverage" name="test_save_new_object_no_existing_max" time="0.006"><failure message="AttributeError: 'Category' object has no attribute 'sort_order'">tests/whitebox/test_core_models.py:34: in test_save_new_object_no_existing_max
    assert category.sort_order == 0
           ^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'Category' object has no attribute 'sort_order'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelStatementCoverage" name="test_save_new_object_with_existing_max" time="0.009"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:56: in test_save_new_object_with_existing_max
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelStatementCoverage" name="test_save_existing_object" time="0.008"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:81: in test_save_existing_object
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelStatementCoverage" name="test_delete_with_sort_order" time="0.010"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:124: in test_delete_with_sort_order
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelStatementCoverage" name="test_delete_without_sort_order" time="0.008"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:157: in test_delete_without_sort_order
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelDecisionCoverage" name="test_decision_coverage_save_pk_none_true" time="0.009"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:193: in test_decision_coverage_save_pk_none_true
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelDecisionCoverage" name="test_decision_coverage_save_pk_none_false" time="0.009"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:217: in test_decision_coverage_save_pk_none_false
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelDecisionCoverage" name="test_decision_coverage_delete_sort_order_not_none_true" time="0.009"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:251: in test_decision_coverage_delete_sort_order_not_none_true
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelDecisionCoverage" name="test_decision_coverage_delete_sort_order_not_none_false" time="0.008"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:275: in test_decision_coverage_delete_sort_order_not_none_false
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelMCDC" name="test_mcdc_get_max_sort_order_none" time="0.009"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:310: in test_mcdc_get_max_sort_order_none
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestSortableModelMCDC" name="test_mcdc_get_max_sort_order_exists" time="0.009"><failure message="NameError: name 'Collection' is not defined">tests/whitebox/test_core_models.py:340: in test_mcdc_get_max_sort_order_exists
    collection = Collection.objects.create(
                 ^^^^^^^^^^
E   NameError: name 'Collection' is not defined</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelStatementCoverage" name="test_published_with_published_at_in_past" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:362: in test_published_with_published_at_in_past
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelStatementCoverage" name="test_published_with_published_at_null" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:379: in test_published_with_published_at_null
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelStatementCoverage" name="test_published_with_published_at_future" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:396: in test_published_with_published_at_future
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelStatementCoverage" name="test_published_with_is_published_false" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:413: in test_published_with_is_published_false
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelDecisionCoverage" name="test_decision_published_at_lte_today_true" time="0.008"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:438: in test_decision_published_at_lte_today_true
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelDecisionCoverage" name="test_decision_published_at_lte_today_false" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:454: in test_decision_published_at_lte_today_false
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelDecisionCoverage" name="test_decision_published_at_isnull_true" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:470: in test_decision_published_at_isnull_true
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelDecisionCoverage" name="test_decision_is_published_true" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:486: in test_decision_is_published_true
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelDecisionCoverage" name="test_decision_is_published_false" time="0.008"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:502: in test_decision_is_published_false
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelMCDC" name="test_mcdc_condition_a_true_b_true" time="0.008"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:526: in test_mcdc_condition_a_true_b_true
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelMCDC" name="test_mcdc_condition_a_false_b_true" time="0.007"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:542: in test_mcdc_condition_a_false_b_true
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelMCDC" name="test_mcdc_condition_a_true_b_false" time="0.008"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:558: in test_mcdc_condition_a_true_b_false
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_models.TestPublishableModelMCDC" name="test_mcdc_condition_null_date" time="0.009"><failure message="TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'">tests/whitebox/test_core_models.py:574: in test_mcdc_condition_null_date
    product = Product.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Product() got unexpected keyword arguments: 'is_published', 'published_at'</failure></testcase><testcase classname="tests.whitebox.test_core_utils.TestGetClientIp" name="test_get_client_ip_x_forwarded_for_single" time="0.005" /><testcase classname="tests.whitebox.test_core_utils.TestGetClientIp" name="test_get_client_ip_x_forwarded_for_multiple" time="0.005" /><testcase classname="tests.whitebox.test_core_utils.TestGetClientIp" name="test_get_client_ip_remote_addr" time="0.005" /><testcase classname="tests.whitebox.test_core_utils.TestGetClientIp" name="test_get_client_ip_invalid_ip" time="0.004" /><testcase classname="tests.whitebox.test_core_utils.TestGetClientIp" name="test_get_client_ip_none" time="0.005"><failure message="AssertionError: assert None == '127.0.0.1'">tests/whitebox/test_core_utils.py:59: in test_get_client_ip_none
    assert ip == "127.0.0.1"
E   AssertionError: assert None == '127.0.0.1'</failure></testcase><testcase classname="tests.whitebox.test_core_utils.TestBuildAbsoluteUri" name="test_build_absolute_uri_with_domain" time="0.005" /><testcase classname="tests.whitebox.test_core_utils.TestBuildAbsoluteUri" name="test_build_absolute_uri_without_domain" time="0.008" /><testcase classname="tests.whitebox.test_core_utils.TestBuildAbsoluteUri" name="test_build_absolute_uri_https" time="0.007"><failure message="TypeError: build_absolute_uri() got an unexpected keyword argument 'protocol'">tests/whitebox/test_core_utils.py:85: in test_build_absolute_uri_https
    uri = build_absolute_uri("/path/to/resource", domain="example.com", protocol="https")
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: build_absolute_uri() got an unexpected keyword argument 'protocol'</failure></testcase><testcase classname="tests.whitebox.test_core_utils.TestBuildAbsoluteUri" name="test_build_absolute_uri_absolute_path" time="0.007" /><testcase classname="tests.whitebox.test_core_utils.TestBuildAbsoluteUri" name="test_build_absolute_uri_relative_path" time="0.007" /><testcase classname="tests.whitebox.test_core_utils.TestGetDomain" name="test_get_domain_with_site" time="0.009" /><testcase classname="tests.whitebox.test_core_utils.TestGetDomain" name="test_get_domain_without_site" time="0.010" /><testcase classname="tests.whitebox.test_core_utils.TestGetDomain" name="test_get_domain_none_site" time="0.008"><failure message="AttributeError: 'NoneType' object has no attribute 'domain'">tests/whitebox/test_core_utils.py:123: in test_get_domain_none_site
    domain = get_domain()
             ^^^^^^^^^^^^
saleor/core/utils/__init__.py:26: in get_domain
    return site.domain
           ^^^^^^^^^^^
E   AttributeError: 'NoneType' object has no attribute 'domain'</failure></testcase><testcase classname="tests.whitebox.test_core_utils.TestGetPublicUrl" name="test_get_public_url_with_domain" time="0.005" /><testcase classname="tests.whitebox.test_core_utils.TestGetPublicUrl" name="test_get_public_url_without_domain" time="0.008"><failure message="django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.">tests/whitebox/test_core_utils.py:145: in test_get_public_url_without_domain
    url = get_public_url()
          ^^^^^^^^^^^^^^^^
saleor/core/utils/__init__.py:32: in get_public_url
    host = domain or Site.objects.get_current().domain
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/site/patch_sites.py:29: in new_get_current
    self.prefetch_related("settings")
.venv/lib/python3.12/site-packages/django/db/models/query.py:437: in __getitem__
    qs._fetch_all()
.venv/lib/python3.12/site-packages/django/db/models/query.py:1954: in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:93: in __iter__
    results = compiler.execute_sql(
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1621: in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/test/testcases.py:201: in __call__
    raise DatabaseOperationForbidden(self.message)
E   django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.</failure></testcase><testcase classname="tests.whitebox.test_core_utils.TestGetPublicUrl" name="test_get_public_url_https" time="0.005"><failure message="TypeError: get_public_url() got an unexpected keyword argument 'protocol'">tests/whitebox/test_core_utils.py:150: in test_get_public_url_https
    url = get_public_url(domain="example.com", protocol="https")
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: get_public_url() got an unexpected keyword argument 'protocol'</failure></testcase><testcase classname="tests.whitebox.test_core_utils.TestGetPublicUrl" name="test_get_public_url_none_domain" time="0.006"><failure message="django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.">tests/whitebox/test_core_utils.py:156: in test_get_public_url_none_domain
    url = get_public_url()
          ^^^^^^^^^^^^^^^^
saleor/core/utils/__init__.py:32: in get_public_url
    host = domain or Site.objects.get_current().domain
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/site/patch_sites.py:29: in new_get_current
    self.prefetch_related("settings")
.venv/lib/python3.12/site-packages/django/db/models/query.py:437: in __getitem__
    qs._fetch_all()
.venv/lib/python3.12/site-packages/django/db/models/query.py:1954: in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:93: in __iter__
    results = compiler.execute_sql(
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1621: in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/test/testcases.py:201: in __call__
    raise DatabaseOperationForbidden(self.message)
E   django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestCalculateDiscountedPriceForRules" name="test_calculate_discounted_price_no_rules" time="0.005" /><testcase classname="tests.whitebox.test_discount_utils.TestCalculateDiscountedPriceForRules" name="test_calculate_discounted_price_with_rules" time="0.009"><failure message="NotImplementedError: Unknown discount type">tests/whitebox/test_discount_utils.py:72: in test_calculate_discounted_price_with_rules
    result = calculate_discounted_price_for_rules(
saleor/discount/utils/promotion.py:86: in calculate_discounted_price_for_rules
    discount = rule.get_discount(currency)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/discount/models.py:426: in get_discount
    raise NotImplementedError("Unknown discount type")
E   NotImplementedError: Unknown discount type</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestCalculateDiscountedPriceForRules" name="test_calculate_discounted_price_multiple_rules" time="0.009"><failure message="NotImplementedError: Unknown discount type">tests/whitebox/test_discount_utils.py:111: in test_calculate_discounted_price_multiple_rules
    result = calculate_discounted_price_for_rules(
saleor/discount/utils/promotion.py:86: in calculate_discounted_price_for_rules
    discount = rule.get_discount(currency)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/discount/models.py:426: in get_discount
    raise NotImplementedError("Unknown discount type")
E   NotImplementedError: Unknown discount type</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestCalculateDiscountedPriceForRules" name="test_calculate_discounted_price_result_negative" time="0.008"><failure message="NotImplementedError: Unknown discount type">tests/whitebox/test_discount_utils.py:143: in test_calculate_discounted_price_result_negative
    result = calculate_discounted_price_for_rules(
saleor/discount/utils/promotion.py:86: in calculate_discounted_price_for_rules
    discount = rule.get_discount(currency)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/discount/models.py:426: in get_discount
    raise NotImplementedError("Unknown discount type")
E   NotImplementedError: Unknown discount type</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestPreparePromotionDiscountReason" name="test_prepare_reason_with_old_sale_id" time="0.006"><failure message="AssertionError: assert '123' in 'Sale: U2FsZToxMjM='&#10; +  where '123' = str(123)&#10; +    where 123 = &lt;Promotion: Promotion object (99c77695-f88b-4250-a93f-109045498921)&gt;.old_sale_id">tests/whitebox/test_discount_utils.py:172: in test_prepare_reason_with_old_sale_id
    assert str(promotion.old_sale_id) in reason
E   AssertionError: assert '123' in 'Sale: U2FsZToxMjM='
E    +  where '123' = str(123)
E    +    where 123 = &lt;Promotion: Promotion object (99c77695-f88b-4250-a93f-109045498921)&gt;.old_sale_id</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestPreparePromotionDiscountReason" name="test_prepare_reason_without_old_sale_id" time="0.007"><failure message="AssertionError: assert '4f00e3b5-1592-411c-ab01-f82667f5aa60' in 'Promotion: UHJvbW90aW9uOjRmMDBlM2I1LTE1OTItNDExYy1hYjAxLWY4MjY2N2Y1YWE2MA=='&#10; +  where '4f00e3b5-1592-411c-ab01-f82667f5aa60' = str(UUID('4f00e3b5-1592-411c-ab01-f82667f5aa60'))&#10; +    where UUID('4f00e3b5-1592-411c-ab01-f82667f5aa60') = &lt;Promotion: Promotion object (4f00e3b5-1592-411c-ab01-f82667f5aa60)&gt;.id">tests/whitebox/test_discount_utils.py:185: in test_prepare_reason_without_old_sale_id
    assert str(promotion.id) in reason
E   AssertionError: assert '4f00e3b5-1592-411c-ab01-f82667f5aa60' in 'Promotion: UHJvbW90aW9uOjRmMDBlM2I1LTE1OTItNDExYy1hYjAxLWY4MjY2N2Y1YWE2MA=='
E    +  where '4f00e3b5-1592-411c-ab01-f82667f5aa60' = str(UUID('4f00e3b5-1592-411c-ab01-f82667f5aa60'))
E    +    where UUID('4f00e3b5-1592-411c-ab01-f82667f5aa60') = &lt;Promotion: Promotion object (4f00e3b5-1592-411c-ab01-f82667f5aa60)&gt;.id</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestGetSaleId" name="test_get_sale_id_with_old_sale_id" time="0.009"><failure message="AssertionError: assert 'Sale' in 'U2FsZTo0NTY='">tests/whitebox/test_discount_utils.py:205: in test_get_sale_id_with_old_sale_id
    assert "Sale" in sale_id
E   AssertionError: assert 'Sale' in 'U2FsZTo0NTY='</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestGetSaleId" name="test_get_sale_id_without_old_sale_id" time="0.010"><failure message="AssertionError: assert 'Promotion' in 'UHJvbW90aW9uOjk1MjFkMDEyLTY5YTctNDg4YS1iNTY1LTJiNTdhMzk1NTgyZA=='">tests/whitebox/test_discount_utils.py:218: in test_get_sale_id_without_old_sale_id
    assert "Promotion" in sale_id
E   AssertionError: assert 'Promotion' in 'UHJvbW90aW9uOjk1MjFkMDEyLTY5YTctNDg4YS1iNTY1LTJiNTdhMzk1NTgyZA=='</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestIsOrderLevelVoucher" name="test_is_order_level_voucher_entire_order" time="0.008"><failure message="AttributeError: property 'code' of 'Voucher' object has no setter">tests/whitebox/test_discount_utils.py:231: in test_is_order_level_voucher_entire_order
    voucher = Voucher.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'code' of 'Voucher' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestIsOrderLevelVoucher" name="test_is_order_level_voucher_shipping" time="0.005"><failure message="AttributeError: property 'code' of 'Voucher' object has no setter">tests/whitebox/test_discount_utils.py:241: in test_is_order_level_voucher_shipping
    voucher = Voucher.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'code' of 'Voucher' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestIsOrderLevelVoucher" name="test_is_order_level_voucher_specific_product" time="0.005"><failure message="AttributeError: property 'code' of 'Voucher' object has no setter">tests/whitebox/test_discount_utils.py:251: in test_is_order_level_voucher_specific_product
    voucher = Voucher.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'code' of 'Voucher' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestIsOrderLevelVoucher" name="test_is_order_level_voucher_none" time="0.004" /><testcase classname="tests.whitebox.test_discount_utils.TestIsShippingVoucher" name="test_is_shipping_voucher_true" time="0.004"><failure message="AttributeError: property 'code' of 'Voucher' object has no setter">tests/whitebox/test_discount_utils.py:274: in test_is_shipping_voucher_true
    voucher = Voucher.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'code' of 'Voucher' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestIsShippingVoucher" name="test_is_shipping_voucher_false" time="0.004"><failure message="AttributeError: property 'code' of 'Voucher' object has no setter">tests/whitebox/test_discount_utils.py:284: in test_is_shipping_voucher_false
    voucher = Voucher.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'code' of 'Voucher' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_discount_utils.TestIsShippingVoucher" name="test_is_shipping_voucher_none" time="0.004" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestCreateOrUpdateDiscountObjectsFromPromotionForCheckout" name="test_create_or_update_discount_objects_returns_soonest_end_date" time="0.010"><failure message="assert datetime.datetime(2025, 12, 10, 13, 26, 6, 151349) == (datetime.datetime(2025, 12, 7, 13, 26, 6, 151425) + datetime.timedelta(days=3))&#10; +  where datetime.datetime(2025, 12, 7, 13, 26, 6, 151425) = &lt;built-in method now of type object at 0xa4fd20&gt;()&#10; +    where &lt;built-in method now of type object at 0xa4fd20&gt; = datetime.now&#10; +  and   datetime.timedelta(days=3) = timedelta(days=3)">tests/whitebox/test_discount_utils_checkout_comprehensive.py:57: in test_create_or_update_discount_objects_returns_soonest_end_date
    assert result == datetime.now() + timedelta(days=3)
E   assert datetime.datetime(2025, 12, 10, 13, 26, 6, 151349) == (datetime.datetime(2025, 12, 7, 13, 26, 6, 151425) + datetime.timedelta(days=3))
E    +  where datetime.datetime(2025, 12, 7, 13, 26, 6, 151425) = &lt;built-in method now of type object at 0xa4fd20&gt;()
E    +    where &lt;built-in method now of type object at 0xa4fd20&gt; = datetime.now
E    +  and   datetime.timedelta(days=3) = timedelta(days=3)</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestCreateOrUpdateDiscountObjectsFromPromotionForCheckout" name="test_create_or_update_discount_objects_returns_catalogue_date_only" time="0.008"><failure message="assert datetime.datetime(2025, 12, 12, 13, 26, 6, 173650) == (datetime.datetime(2025, 12, 7, 13, 26, 6, 173729) + datetime.timedelta(days=5))&#10; +  where datetime.datetime(2025, 12, 7, 13, 26, 6, 173729) = &lt;built-in method now of type object at 0xa4fd20&gt;()&#10; +    where &lt;built-in method now of type object at 0xa4fd20&gt; = datetime.now&#10; +  and   datetime.timedelta(days=5) = timedelta(days=5)">tests/whitebox/test_discount_utils_checkout_comprehensive.py:86: in test_create_or_update_discount_objects_returns_catalogue_date_only
    assert result == datetime.now() + timedelta(days=5)
E   assert datetime.datetime(2025, 12, 12, 13, 26, 6, 173650) == (datetime.datetime(2025, 12, 7, 13, 26, 6, 173729) + datetime.timedelta(days=5))
E    +  where datetime.datetime(2025, 12, 7, 13, 26, 6, 173729) = &lt;built-in method now of type object at 0xa4fd20&gt;()
E    +    where &lt;built-in method now of type object at 0xa4fd20&gt; = datetime.now
E    +  and   datetime.timedelta(days=5) = timedelta(days=5)</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestCreateOrUpdateDiscountObjectsFromPromotionForCheckout" name="test_create_or_update_discount_objects_returns_order_date_only" time="0.009"><failure message="assert datetime.datetime(2025, 12, 10, 13, 26, 6, 195647) == (datetime.datetime(2025, 12, 7, 13, 26, 6, 195722) + datetime.timedelta(days=3))&#10; +  where datetime.datetime(2025, 12, 7, 13, 26, 6, 195722) = &lt;built-in method now of type object at 0xa4fd20&gt;()&#10; +    where &lt;built-in method now of type object at 0xa4fd20&gt; = datetime.now&#10; +  and   datetime.timedelta(days=3) = timedelta(days=3)">tests/whitebox/test_discount_utils_checkout_comprehensive.py:115: in test_create_or_update_discount_objects_returns_order_date_only
    assert result == datetime.now() + timedelta(days=3)
E   assert datetime.datetime(2025, 12, 10, 13, 26, 6, 195647) == (datetime.datetime(2025, 12, 7, 13, 26, 6, 195722) + datetime.timedelta(days=3))
E    +  where datetime.datetime(2025, 12, 7, 13, 26, 6, 195722) = &lt;built-in method now of type object at 0xa4fd20&gt;()
E    +    where &lt;built-in method now of type object at 0xa4fd20&gt; = datetime.now
E    +  and   datetime.timedelta(days=3) = timedelta(days=3)</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestCreateOrUpdateDiscountObjectsFromPromotionForCheckout" name="test_create_or_update_discount_objects_returns_none_when_both_none" time="0.008" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestPrepareCheckoutLineDiscountObjectsForCataloguePromotions" name="test_prepare_checkout_line_discount_returns_none_when_no_lines" time="0.004" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestPrepareCheckoutLineDiscountObjectsForCataloguePromotions" name="test_prepare_checkout_line_discount_skips_line_without_channel_listing" time="0.005" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestPrepareCheckoutLineDiscountObjectsForCataloguePromotions" name="test_prepare_checkout_line_discount_removes_when_manual_discount_exists" time="0.004" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestPrepareCheckoutLineDiscountObjectsForCataloguePromotions" name="test_prepare_checkout_line_discount_removes_when_not_discounted" time="0.008" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestPrepareCheckoutLineDiscountObjectsForCataloguePromotions" name="test_prepare_checkout_line_discount_removes_when_gift" time="0.008" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestCreateCheckoutDiscountObjectsForOrderPromotions" name="test_create_checkout_discount_clears_when_voucher_code_exists" time="0.011" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestCreateCheckoutDiscountObjectsForOrderPromotions" name="test_create_checkout_discount_clears_when_no_promotion_applied" time="0.009" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestSetCheckoutBasePrices" name="test_set_checkout_base_prices_updates_when_different" time="0.012" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestSetCheckoutBasePrices" name="test_set_checkout_base_prices_skips_when_same" time="0.011" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestClearCheckoutDiscount" name="test_clear_checkout_discount_deletes_order_promotion_discounts" time="0.012" /><testcase classname="tests.whitebox.test_discount_utils_checkout_comprehensive.TestClearCheckoutDiscount" name="test_clear_checkout_discount_clears_voucher_fields" time="0.012"><failure message="AssertionError: assert None == ''&#10; +  where None = &lt;Checkout: Checkout object (d853be94-2d1c-4258-b575-3775ddb7e61b)&gt;.discount_name">tests/whitebox/test_discount_utils_checkout_comprehensive.py:397: in test_clear_checkout_discount_clears_voucher_fields
    assert checkout.discount_name == ""
E   AssertionError: assert None == ''
E    +  where None = &lt;Checkout: Checkout object (d853be94-2d1c-4258-b575-3775ddb7e61b)&gt;.discount_name</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestCreateOrderLineDiscountObjects" name="test_create_order_line_discount_objects_returns_none_when_no_data" time="0.005" /><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestCreateOrderLineDiscountObjects" name="test_create_order_line_discount_objects_returns_none_when_no_lines" time="0.005" /><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestCreateOrderLineDiscountObjects" name="test_create_order_line_discount_objects_removes_discounts" time="0.013"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 145a7979-ff0c-4d25-882c-d29e4ec2676f, 4c68e052-4fb8-4fca-b60a-d48eba2286e7, null, 2025-12-07 13:26:06.364114+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 145a7979-ff0c-4d25-882c-d29e4ec2676f, 4c68e052-4fb8-4fca-b60a-d48eba2286e7, null, 2025-12-07 13:26:06.364114+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_discount_utils_order_comprehensive.py:55: in test_create_order_line_discount_objects_removes_discounts
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 145a7979-ff0c-4d25-882c-d29e4ec2676f, 4c68e052-4fb8-4fca-b60a-d48eba2286e7, null, 2025-12-07 13:26:06.364114+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestCreateOrderLineDiscountObjects" name="test_create_order_line_discount_objects_creates_discounts" time="0.010"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 7db23cb4-4565-45c9-b923-ec1e9fefa138, 5e40b4ee-8626-4fd8-95d4-abd3fa6c4c97, null, 2025-12-07 13:26:06.877332+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 7db23cb4-4565-45c9-b923-ec1e9fefa138, 5e40b4ee-8626-4fd8-95d4-abd3fa6c4c97, null, 2025-12-07 13:26:06.877332+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_discount_utils_order_comprehensive.py:96: in test_create_order_line_discount_objects_creates_discounts
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 7db23cb4-4565-45c9-b923-ec1e9fefa138, 5e40b4ee-8626-4fd8-95d4-abd3fa6c4c97, null, 2025-12-07 13:26:06.877332+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestUpdateCataloguePromotionDiscountAmountForOrder" name="test_update_catalogue_promotion_discount_amount_updates_amount" time="0.010"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 2, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 85eb9152-ed9e-4580-937f-e51c8a6fc3b9, 9beb6fce-56f2-4c2b-b890-565a89efee16, null, 2025-12-07 13:26:07.390728+00, 0.000, 10.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 2, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 85eb9152-ed9e-4580-937f-e51c8a6fc3b9, 9beb6fce-56f2-4c2b-b890-565a89efee16, null, 2025-12-07 13:26:07.390728+00, 0.000, 10.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_discount_utils_order_comprehensive.py:142: in test_update_catalogue_promotion_discount_amount_updates_amount
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 2, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 85eb9152-ed9e-4580-937f-e51c8a6fc3b9, 9beb6fce-56f2-4c2b-b890-565a89efee16, null, 2025-12-07 13:26:07.390728+00, 0.000, 10.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestUpdateUnitDiscountDataOnOrderLine" name="test_update_unit_discount_data_sets_fields_when_no_discounts" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 70b19e96-8283-4996-924c-f6ef1e973bb2, cd2f3cbe-3c01-44e2-b649-0ef6aa609660, null, 2025-12-07 13:26:07.895663+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 70b19e96-8283-4996-924c-f6ef1e973bb2, cd2f3cbe-3c01-44e2-b649-0ef6aa609660, null, 2025-12-07 13:26:07.895663+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_discount_utils_order_comprehensive.py:188: in test_update_unit_discount_data_sets_fields_when_no_discounts
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 70b19e96-8283-4996-924c-f6ef1e973bb2, cd2f3cbe-3c01-44e2-b649-0ef6aa609660, null, 2025-12-07 13:26:07.895663+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestUpdateUnitDiscountDataOnOrderLine" name="test_update_unit_discount_data_sets_fields_for_single_discount" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 2, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 34633b85-5cee-4431-bd92-732dbc525c08, c8b25b83-73c1-4de9-be37-8fd7ead1267f, null, 2025-12-07 13:26:08.329732+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 2, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 34633b85-5cee-4431-bd92-732dbc525c08, c8b25b83-73c1-4de9-be37-8fd7ead1267f, null, 2025-12-07 13:26:08.329732+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_discount_utils_order_comprehensive.py:219: in test_update_unit_discount_data_sets_fields_for_single_discount
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 2, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 34633b85-5cee-4431-bd92-732dbc525c08, c8b25b83-73c1-4de9-be37-8fd7ead1267f, null, 2025-12-07 13:26:08.329732+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestUpdateUnitDiscountDataOnOrderLine" name="test_update_unit_discount_data_sets_fixed_type_for_multiple_discounts" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 0a9e2d64-4384-4949-8e8a-7416623b4818, cd0e3130-d50d-479f-acfb-16200d012957, null, 2025-12-07 13:26:08.755906+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 0a9e2d64-4384-4949-8e8a-7416623b4818, cd0e3130-d50d-479f-acfb-16200d012957, null, 2025-12-07 13:26:08.755906+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_discount_utils_order_comprehensive.py:259: in test_update_unit_discount_data_sets_fixed_type_for_multiple_discounts
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 0a9e2d64-4384-4949-8e8a-7416623b4818, cd0e3130-d50d-479f-acfb-16200d012957, null, 2025-12-07 13:26:08.755906+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestHandleOrderPromotion" name="test_handle_order_promotion_calls_create_discount_objects" time="0.011" /><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestCreateOrderDiscountObjectsForOrderPromotions" name="test_create_order_discount_clears_when_voucher_code_exists" time="0.009" /><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestCreateOrderDiscountObjectsForOrderPromotions" name="test_create_order_discount_clears_when_manual_discount_exists" time="0.012" /><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestSetOrderBasePrices" name="test_set_order_base_prices_updates_when_different" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 90.000, 90.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 2f747168-50dd-42db-8ff4-65557ff0a779, cff14430-23d6-4d16-9e9c-ec74f0bdd26a, null, 2025-12-07 13:26:09.223633+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 90.000, 90.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 2f747168-50dd-42db-8ff4-65557ff0a779, cff14430-23d6-4d16-9e9c-ec74f0bdd26a, null, 2025-12-07 13:26:09.223633+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_discount_utils_order_comprehensive.py:393: in test_set_order_base_prices_updates_when_different
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 90.000, 90.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 2f747168-50dd-42db-8ff4-65557ff0a779, cff14430-23d6-4d16-9e9c-ec74f0bdd26a, null, 2025-12-07 13:26:09.223633+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestSetOrderBasePrices" name="test_set_order_base_prices_skips_when_same" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 100.000, 100.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 5a1332cb-97ac-41ef-831b-d36f191c6a00, c76294a6-e98e-4e52-ad14-9c65d539bad7, null, 2025-12-07 13:26:09.649326+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 100.000, 100.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 5a1332cb-97ac-41ef-831b-d36f191c6a00, c76294a6-e98e-4e52-ad14-9c65d539bad7, null, 2025-12-07 13:26:09.649326+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_discount_utils_order_comprehensive.py:432: in test_set_order_base_prices_skips_when_same
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 100.000, 100.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 5a1332cb-97ac-41ef-831b-d36f191c6a00, c76294a6-e98e-4e52-ad14-9c65d539bad7, null, 2025-12-07 13:26:09.649326+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_discount_utils_order_comprehensive.TestClearOrderDiscount" name="test_clear_order_discount_deletes_order_promotion_discounts" time="0.018" /><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestCleanMarkOrderAsPaid" name="test_clean_mark_order_as_paid_raises_when_payments_exist" time="0.015" /><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestCleanMarkOrderAsPaid" name="test_clean_mark_order_as_paid_raises_when_transactions_exist" time="0.015" /><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestCleanMarkOrderAsPaid" name="test_clean_mark_order_as_paid_passes_when_no_payments_or_transactions" time="0.010" /><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestIncreaseOrderLineQuantity" name="test_increase_order_line_quantity_updates_fulfilled_quantity" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 10.000, null, 2, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 7a78f90f-4ed0-4b20-ab33-6a38c32a6a86, dd27dc3f-d383-4e7c-b6f6-bcadd365ca39, null, 2025-12-07 13:26:10.142751+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 10.000, null, 2, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 7a78f90f-4ed0-4b20-ab33-6a38c32a6a86, dd27dc3f-d383-4e7c-b6f6-bcadd365ca39, null, 2025-12-07 13:26:10.142751+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:137: in test_increase_order_line_quantity_updates_fulfilled_quantity
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 10.000, null, 2, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 7a78f90f-4ed0-4b20-ab33-6a38c32a6a86, dd27dc3f-d383-4e7c-b6f6-bcadd365ca39, null, 2025-12-07 13:26:10.142751+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestFulfillOrderLines" name="test_fulfill_order_lines_decreases_stock_and_increases_quantity" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (e8bcdcbd-dc4a-4076-a408-0d8e9335500b, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (e8bcdcbd-dc4a-4076-a408-0d8e9335500b, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:172: in test_fulfill_order_lines_decreases_stock_and_increases_quantity
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (e8bcdcbd-dc4a-4076-a408-0d8e9335500b, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestGetFulfillmentLineIfExists" name="test_get_fulfillment_line_if_exists_returns_line_when_found" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 30546cb1-b6ea-460d-a8ae-38845e223ed4, 29577e2d-9040-4499-852d-2c9d936a6491, null, 2025-12-07 13:26:11.025494+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 30546cb1-b6ea-460d-a8ae-38845e223ed4, 29577e2d-9040-4499-852d-2c9d936a6491, null, 2025-12-07 13:26:11.025494+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:247: in test_get_fulfillment_line_if_exists_returns_line_when_found
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 30546cb1-b6ea-460d-a8ae-38845e223ed4, 29577e2d-9040-4499-852d-2c9d936a6491, null, 2025-12-07 13:26:11.025494+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestGetFulfillmentLineIfExists" name="test_get_fulfillment_line_if_exists_returns_none_when_not_found" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, da4682b1-1ce6-4ead-a1b1-ab7e18047bdf, 331988f5-d074-48f9-af3b-db836fae9977, null, 2025-12-07 13:26:11.450814+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, da4682b1-1ce6-4ead-a1b1-ab7e18047bdf, 331988f5-d074-48f9-af3b-db836fae9977, null, 2025-12-07 13:26:11.450814+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:285: in test_get_fulfillment_line_if_exists_returns_none_when_not_found
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, da4682b1-1ce6-4ead-a1b1-ab7e18047bdf, 331988f5-d074-48f9-af3b-db836fae9977, null, 2025-12-07 13:26:11.450814+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestGetFulfillmentLine" name="test_get_fulfillment_line_returns_existing_line" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 0489ae80-73bb-4498-becb-221d345e59f7, daa9560d-8453-4db0-a7bb-e78ebbb287b1, null, 2025-12-07 13:26:11.876015+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 0489ae80-73bb-4498-becb-221d345e59f7, daa9560d-8453-4db0-a7bb-e78ebbb287b1, null, 2025-12-07 13:26:11.876015+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:328: in test_get_fulfillment_line_returns_existing_line
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 0489ae80-73bb-4498-becb-221d345e59f7, daa9560d-8453-4db0-a7bb-e78ebbb287b1, null, 2025-12-07 13:26:11.876015+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestGetFulfillmentLine" name="test_get_fulfillment_line_creates_new_line_when_not_exists" time="0.011"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, df6fe0ef-4d27-468b-ab54-791c7d110d20, 6c27a5ac-1a71-4b92-a74d-cc05dd4373ee, null, 2025-12-07 13:26:12.310506+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, df6fe0ef-4d27-468b-ab54-791c7d110d20, 6c27a5ac-1a71-4b92-a74d-cc05dd4373ee, null, 2025-12-07 13:26:12.310506+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:368: in test_get_fulfillment_line_creates_new_line_when_not_exists
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, df6fe0ef-4d27-468b-ab54-791c7d110d20, 6c27a5ac-1a71-4b92-a74d-cc05dd4373ee, null, 2025-12-07 13:26:12.310506+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestGetShippingRefundAmount" name="test_get_shipping_refund_amount_returns_shipping_when_refund_shipping_and_no_amount" time="0.004"><failure message="NameError: name '_TestGetShippingRefundAmount__get_shipping_refund_amount' is not defined">tests/whitebox/test_order_actions_comprehensive.py:399: in test_get_shipping_refund_amount_returns_shipping_when_refund_shipping_and_no_amount
    result = __get_shipping_refund_amount(True, None, shipping_price)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   NameError: name '_TestGetShippingRefundAmount__get_shipping_refund_amount' is not defined</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestGetShippingRefundAmount" name="test_get_shipping_refund_amount_returns_none_when_refund_shipping_false" time="0.004"><failure message="NameError: name '_TestGetShippingRefundAmount__get_shipping_refund_amount' is not defined">tests/whitebox/test_order_actions_comprehensive.py:405: in test_get_shipping_refund_amount_returns_none_when_refund_shipping_false
    result = __get_shipping_refund_amount(False, None, shipping_price)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   NameError: name '_TestGetShippingRefundAmount__get_shipping_refund_amount' is not defined</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestGetShippingRefundAmount" name="test_get_shipping_refund_amount_returns_none_when_amount_provided" time="0.004"><failure message="NameError: name '_TestGetShippingRefundAmount__get_shipping_refund_amount' is not defined">tests/whitebox/test_order_actions_comprehensive.py:411: in test_get_shipping_refund_amount_returns_none_when_amount_provided
    result = __get_shipping_refund_amount(True, Decimal("50.00"), shipping_price)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   NameError: name '_TestGetShippingRefundAmount__get_shipping_refund_amount' is not defined</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestPopulateReplaceOrderFields" name="test_populate_replace_order_fields_copies_order_fields" time="0.572"><failure message="AttributeError: type object 'OrderStatus' has no attribute 'CONFIRMED'. Did you mean: 'UNCONFIRMED'?">tests/whitebox/test_order_actions_comprehensive.py:430: in test_populate_replace_order_fields_copies_order_fields
    status=OrderStatus.CONFIRMED,
           ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: type object 'OrderStatus' has no attribute 'CONFIRMED'. Did you mean: 'UNCONFIRMED'?</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestDecreaseFulfilledQuantity" name="test_decrease_fulfilled_quantity_decreases_quantity" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 10.000, null, 3, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 51488df4-6d33-4356-8a09-1c75b763a183, 16a76a50-243f-44a3-8a9f-ff877b9dcf53, null, 2025-12-07 13:26:13.372037+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 10.000, null, 3, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 51488df4-6d33-4356-8a09-1c75b763a183, 16a76a50-243f-44a3-8a9f-ff877b9dcf53, null, 2025-12-07 13:26:13.372037+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:466: in test_decrease_fulfilled_quantity_decreases_quantity
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 10.000, null, 3, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 51488df4-6d33-4356-8a09-1c75b763a183, 16a76a50-243f-44a3-8a9f-ff877b9dcf53, null, 2025-12-07 13:26:13.372037+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestCalculateRefundAmount" name="test_calculate_refund_amount_calculates_from_order_lines" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product 1, SKU1, 2, 10.000, 12.000, null, 0, null, null, , USD, , Variant 1, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 481c999f-32cc-4f01-8b94-7c702928d69c, 8cafe7e1-8713-4002-82c0-f731edabacd3, null, 2025-12-07 13:26:14.095616+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product 1, SKU1, 2, 10.000, 12.000, null, 0, null, null, , USD, , Variant 1, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 481c999f-32cc-4f01-8b94-7c702928d69c, 8cafe7e1-8713-4002-82c0-f731edabacd3, null, 2025-12-07 13:26:14.095616+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:507: in test_calculate_refund_amount_calculates_from_order_lines
    line1 = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product 1, SKU1, 2, 10.000, 12.000, null, 0, null, null, , USD, , Variant 1, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 481c999f-32cc-4f01-8b94-7c702928d69c, 8cafe7e1-8713-4002-82c0-f731edabacd3, null, 2025-12-07 13:26:14.095616+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestCalculateRefundAmount" name="test_calculate_refund_amount_includes_fulfillment_lines" time="0.011"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 12.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, dce98db2-b25e-4916-abc2-99c8f445c564, 3f466edd-9eb7-484b-b973-3740a7b1cd59, null, 2025-12-07 13:26:14.535189+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 12.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, dce98db2-b25e-4916-abc2-99c8f445c564, 3f466edd-9eb7-484b-b973-3740a7b1cd59, null, 2025-12-07 13:26:14.535189+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:554: in test_calculate_refund_amount_includes_fulfillment_lines
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 12.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, dce98db2-b25e-4916-abc2-99c8f445c564, 3f466edd-9eb7-484b-b973-3740a7b1cd59, null, 2025-12-07 13:26:14.535189+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_actions_comprehensive.TestCalculateRefundAmount" name="test_calculate_refund_amount_skips_already_refunded_lines" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 12.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 5a840d42-56ba-4e4c-a793-fcd71f6fbf97, 29c893d9-6624-4501-b6eb-7335071f9445, null, 2025-12-07 13:26:14.954908+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 12.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 5a840d42-56ba-4e4c-a793-fcd71f6fbf97, 29c893d9-6624-4501-b6eb-7335071f9445, null, 2025-12-07 13:26:14.954908+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_actions_comprehensive.py:596: in test_calculate_refund_amount_skips_already_refunded_lines
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 5, 10.000, 12.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 5a840d42-56ba-4e4c-a793-fcd71f6fbf97, 29c893d9-6624-4501-b6eb-7335071f9445, null, 2025-12-07 13:26:14.954908+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations.TestBaseOrderShipping" name="test_base_order_shipping" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:15.399808+00, , , c88574e5-f099-4993-9711-56bd4820f39d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 133, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:15.400533+00, f, 25, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:15.399808+00, , , c88574e5-f099-4993-9711-56bd4820f39d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 133, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:15.400533+00, f, 25, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations.py:42: in test_base_order_shipping
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:15.399808+00, , , c88574e5-f099-4993-9711-56bd4820f39d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 133, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:15.400533+00, f, 25, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations.TestBaseOrderSubtotal" name="test_base_order_subtotal_single_line" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:15.828478+00, , , 2568cb04-02f8-4b67-a889-6205ac1d8a8c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 134, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:15.829097+00, f, 26, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:15.828478+00, , , 2568cb04-02f8-4b67-a889-6205ac1d8a8c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 134, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:15.829097+00, f, 26, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations.py:68: in test_base_order_subtotal_single_line
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:15.828478+00, , , 2568cb04-02f8-4b67-a889-6205ac1d8a8c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 134, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:15.829097+00, f, 26, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations.TestBaseOrderSubtotal" name="test_base_order_subtotal_multiple_lines" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:16.236961+00, , , 6ad87235-1f6c-40f8-9b12-9c0acea07286, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 135, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:16.237632+00, f, 27, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:16.236961+00, , , 6ad87235-1f6c-40f8-9b12-9c0acea07286, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 135, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:16.237632+00, f, 27, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations.py:111: in test_base_order_subtotal_multiple_lines
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:16.236961+00, , , 6ad87235-1f6c-40f8-9b12-9c0acea07286, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 135, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:16.237632+00, f, 27, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations.TestBaseOrderSubtotal" name="test_base_order_subtotal_empty_lines" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:16.656229+00, , , bd4eeb3d-9fee-452f-a0ff-e5a7b099e9cc, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 136, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:16.656875+00, f, 28, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:16.656229+00, , , bd4eeb3d-9fee-452f-a0ff-e5a7b099e9cc, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 136, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:16.656875+00, f, 28, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations.py:163: in test_base_order_subtotal_empty_lines
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:16.656229+00, , , bd4eeb3d-9fee-452f-a0ff-e5a7b099e9cc, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 136, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:16.656875+00, f, 28, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations.TestBaseOrderLineTotal" name="test_base_order_line_total" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:17.082181+00, , , 5ca68883-8172-419d-a56a-ad8699014210, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 137, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:17.082919+00, f, 29, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:17.082181+00, , , 5ca68883-8172-419d-a56a-ad8699014210, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 137, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:17.082919+00, f, 29, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations.py:188: in test_base_order_line_total
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:17.082181+00, , , 5ca68883-8172-419d-a56a-ad8699014210, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 137, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:17.082919+00, f, 29, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations.TestBaseOrderTotal" name="test_base_order_total" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:17.498259+00, , , a426d859-49c8-4064-922b-71839f9a2a8d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 138, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:17.49892+00, f, 30, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:17.498259+00, , , a426d859-49c8-4064-922b-71839f9a2a8d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 138, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:17.49892+00, f, 30, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations.py:243: in test_base_order_total
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:17.498259+00, , , a426d859-49c8-4064-922b-71839f9a2a8d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 138, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:17.49892+00, f, 30, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_discount_no_discounts" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:17.91932+00, , , 37834cfb-0da7-421f-a9c3-ba0afd5048ae, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 139, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:17.919957+00, f, 31, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:17.91932+00, , , 37834cfb-0da7-421f-a9c3-ba0afd5048ae, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 139, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:17.919957+00, f, 31, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations.py:299: in test_propagate_discount_no_discounts
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:17.91932+00, , , 37834cfb-0da7-421f-a9c3-ba0afd5048ae, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 139, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:17.919957+00, f, 31, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_discount_with_entire_order_voucher" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:18.337743+00, , , a8f55599-6312-4171-9a91-48ed60e40894, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 140, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:18.338359+00, f, 32, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:18.337743+00, , , a8f55599-6312-4171-9a91-48ed60e40894, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 140, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:18.338359+00, f, 32, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations.py:341: in test_propagate_discount_with_entire_order_voucher
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:18.337743+00, , , a8f55599-6312-4171-9a91-48ed60e40894, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 140, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:18.338359+00, f, 32, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestBaseOrderShipping" name="test_base_order_shipping_returns_base_shipping_price" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:18.749581+00, , , c41abbac-a185-4962-ac97-6aa41f1b08cf, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 141, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:18.750181+00, f, 33, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:18.749581+00, , , c41abbac-a185-4962-ac97-6aa41f1b08cf, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 141, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:18.750181+00, f, 33, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:63: in test_base_order_shipping_returns_base_shipping_price
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:18.749581+00, , , c41abbac-a185-4962-ac97-6aa41f1b08cf, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 141, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:18.750181+00, f, 33, null, 0.000, none, none, null, t, f, 10.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestBaseOrderSubtotal" name="test_base_order_subtotal_empty_lines" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:19.174354+00, , , a6bf7a95-f99f-44e6-9463-8db92410f7da, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 142, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:19.17499+00, f, 34, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:19.174354+00, , , a6bf7a95-f99f-44e6-9463-8db92410f7da, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 142, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:19.17499+00, f, 34, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:85: in test_base_order_subtotal_empty_lines
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:19.174354+00, , , a6bf7a95-f99f-44e6-9463-8db92410f7da, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 142, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:19.17499+00, f, 34, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestBaseOrderSubtotal" name="test_base_order_subtotal_single_line" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:19.610359+00, , , 2d43d811-90ee-414c-8c6a-c1655b5f7c7a, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 143, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:19.611013+00, f, 35, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:19.610359+00, , , 2d43d811-90ee-414c-8c6a-c1655b5f7c7a, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 143, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:19.611013+00, f, 35, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:100: in test_base_order_subtotal_single_line
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:19.610359+00, , , 2d43d811-90ee-414c-8c6a-c1655b5f7c7a, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 143, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:19.611013+00, f, 35, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestBaseOrderSubtotal" name="test_base_order_subtotal_multiple_lines" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:20.040894+00, , , 28eaf278-13f5-4e55-926c-b067facee504, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 144, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:20.041591+00, f, 36, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:20.040894+00, , , 28eaf278-13f5-4e55-926c-b067facee504, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 144, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:20.041591+00, f, 36, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:120: in test_base_order_subtotal_multiple_lines
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:20.040894+00, , , 28eaf278-13f5-4e55-926c-b067facee504, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 144, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:20.041591+00, f, 36, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestBaseOrderTotal" name="test_base_order_total_calls_calculate_prices" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:20.504823+00, , , afce452e-a10b-4a66-beb4-1c36d0b6a7d9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 145, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:20.505455+00, f, 37, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:20.504823+00, , , afce452e-a10b-4a66-beb4-1c36d0b6a7d9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 145, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:20.505455+00, f, 37, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:151: in test_base_order_total_calls_calculate_prices
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:20.504823+00, , , afce452e-a10b-4a66-beb4-1c36d0b6a7d9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 145, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:20.505455+00, f, 37, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestBaseOrderLineTotal" name="test_base_order_line_total_calculates_correctly" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:21.186554+00, , , bebb3c1c-aaf5-4aff-b1db-1f82314746ea, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 146, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:21.187244+00, f, 38, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:21.186554+00, , , bebb3c1c-aaf5-4aff-b1db-1f82314746ea, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 146, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:21.187244+00, f, 38, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:182: in test_base_order_line_total_calculates_correctly
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:21.186554+00, , , bebb3c1c-aaf5-4aff-b1db-1f82314746ea, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 146, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:21.187244+00, f, 38, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_order_discount_no_discounts" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:21.5983+00, , , b107688d-d200-47b3-9748-dc42b015ccf0, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 147, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:21.598942+00, f, 39, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:21.5983+00, , , b107688d-d200-47b3-9748-dc42b015ccf0, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 147, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:21.598942+00, f, 39, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:209: in test_propagate_order_discount_no_discounts
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:21.5983+00, , , b107688d-d200-47b3-9748-dc42b015ccf0, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 147, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:21.598942+00, f, 39, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_order_discount_voucher_order_level" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:22.014097+00, , , 361d3def-9491-4f33-b510-2657c457a16d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 148, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:22.014771+00, f, 40, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:22.014097+00, , , 361d3def-9491-4f33-b510-2657c457a16d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 148, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:22.014771+00, f, 40, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:231: in test_propagate_order_discount_voucher_order_level
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:22.014097+00, , , 361d3def-9491-4f33-b510-2657c457a16d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 148, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:22.014771+00, f, 40, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_order_discount_voucher_shipping" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:22.444393+00, , , 6d73e8de-6a62-48e5-ac79-5412a7de521c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 149, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:22.445088+00, f, 41, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:22.444393+00, , , 6d73e8de-6a62-48e5-ac79-5412a7de521c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 149, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:22.445088+00, f, 41, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:268: in test_propagate_order_discount_voucher_shipping
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:22.444393+00, , , 6d73e8de-6a62-48e5-ac79-5412a7de521c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 149, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:22.445088+00, f, 41, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_order_discount_order_promotion" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:22.88601+00, , , a7242fe1-2bdc-4d75-8030-2d5dc9e752ac, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 150, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:22.886733+00, f, 42, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:22.88601+00, , , a7242fe1-2bdc-4d75-8030-2d5dc9e752ac, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 150, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:22.886733+00, f, 42, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:303: in test_propagate_order_discount_order_promotion
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:22.88601+00, , , a7242fe1-2bdc-4d75-8030-2d5dc9e752ac, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 150, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:22.886733+00, f, 42, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_order_discount_manual_percentage" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:23.330359+00, , , 252993a4-a6f9-4506-a138-addd589243b5, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 151, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:23.331429+00, f, 43, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:23.330359+00, , , 252993a4-a6f9-4506-a138-addd589243b5, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 151, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:23.331429+00, f, 43, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:335: in test_propagate_order_discount_manual_percentage
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:23.330359+00, , , 252993a4-a6f9-4506-a138-addd589243b5, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 151, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:23.331429+00, f, 43, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_order_discount_manual_fixed_positive_total" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:23.842274+00, , , 44f646de-2752-4112-aa4c-72f0b1ebd440, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 152, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:23.843018+00, f, 44, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:23.842274+00, , , 44f646de-2752-4112-aa4c-72f0b1ebd440, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 152, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:23.843018+00, f, 44, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:370: in test_propagate_order_discount_manual_fixed_positive_total
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:23.842274+00, , , 44f646de-2752-4112-aa4c-72f0b1ebd440, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 152, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:23.843018+00, f, 44, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_order_discount_manual_fixed_zero_total" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:24.303118+00, , , 7fbef9a0-8c9f-41ce-a483-828ee5ea8ac9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 153, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:24.303789+00, f, 45, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:24.303118+00, , , 7fbef9a0-8c9f-41ce-a483-828ee5ea8ac9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 153, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:24.303789+00, f, 45, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:403: in test_propagate_order_discount_manual_fixed_zero_total
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:24.303118+00, , , 7fbef9a0-8c9f-41ce-a483-828ee5ea8ac9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 153, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:24.303789+00, f, 45, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderPrices" name="test_propagate_order_discount_updates_amount" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:24.743506+00, , , a28946dd-57eb-4846-9633-497fbe4f11d1, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 154, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:24.744184+00, f, 46, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:24.743506+00, , , a28946dd-57eb-4846-9633-497fbe4f11d1, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 154, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:24.744184+00, f, 46, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:435: in test_propagate_order_discount_updates_amount
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:24.743506+00, , , a28946dd-57eb-4846-9633-497fbe4f11d1, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 154, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:24.744184+00, f, 46, null, 0.000, none, none, null, t, f, 5.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestCalculatePrices" name="test_calculate_prices_with_assign_prices_true" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:25.228641+00, , , 54c4b421-3b87-494c-9cf3-e0d88c36dadd, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 155, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:25.22931+00, f, 47, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:25.228641+00, , , 54c4b421-3b87-494c-9cf3-e0d88c36dadd, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 155, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:25.22931+00, f, 47, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:478: in test_calculate_prices_with_assign_prices_true
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:25.228641+00, , , 54c4b421-3b87-494c-9cf3-e0d88c36dadd, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 155, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:25.22931+00, f, 47, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestCalculatePrices" name="test_calculate_prices_with_assign_prices_false" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:25.680057+00, , , d96cca6e-f417-4640-bcd1-778e2701e8a2, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 156, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:25.680681+00, f, 48, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:25.680057+00, , , d96cca6e-f417-4640-bcd1-778e2701e8a2, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 156, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:25.680681+00, f, 48, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:507: in test_calculate_prices_with_assign_prices_false
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:25.680057+00, , , d96cca6e-f417-4640-bcd1-778e2701e8a2, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 156, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:25.680681+00, f, 48, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestGetTotalPriceWithSubtotalDiscountForOrderLine" name="test_get_total_price_positive_discount" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:26.109166+00, , , 65a30bf5-b81c-499a-894d-5a01512b128e, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 157, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:26.109831+00, f, 49, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:26.109166+00, , , 65a30bf5-b81c-499a-894d-5a01512b128e, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 157, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:26.109831+00, f, 49, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:537: in test_get_total_price_positive_discount
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:26.109166+00, , , 65a30bf5-b81c-499a-894d-5a01512b128e, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 157, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:26.109831+00, f, 49, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestGetTotalPriceWithSubtotalDiscountForOrderLine" name="test_get_total_price_discount_exceeds_total" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:26.547984+00, , , 1f0b2ebf-274b-4c93-83a0-069b356e09f2, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 158, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:26.548685+00, f, 50, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:26.547984+00, , , 1f0b2ebf-274b-4c93-83a0-069b356e09f2, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 158, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:26.548685+00, f, 50, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:558: in test_get_total_price_discount_exceeds_total
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:26.547984+00, , , 1f0b2ebf-274b-4c93-83a0-069b356e09f2, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 158, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:26.548685+00, f, 50, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderLinesPrices" name="test_propagate_discount_single_line" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:26.978692+00, , , 0f996bdb-bedc-40da-9e5c-a55c977787f6, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 159, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:26.979323+00, f, 51, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:26.978692+00, , , 0f996bdb-bedc-40da-9e5c-a55c977787f6, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 159, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:26.979323+00, f, 51, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:584: in test_propagate_discount_single_line
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:26.978692+00, , , 0f996bdb-bedc-40da-9e5c-a55c977787f6, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 159, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:26.979323+00, f, 51, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderLinesPrices" name="test_propagate_discount_multiple_lines" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:27.400545+00, , , a5003ca6-3b83-4cbb-be16-7c2e6c9a45ff, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 160, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:27.401179+00, f, 52, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:27.400545+00, , , a5003ca6-3b83-4cbb-be16-7c2e6c9a45ff, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 160, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:27.401179+00, f, 52, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:612: in test_propagate_discount_multiple_lines
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:27.400545+00, , , a5003ca6-3b83-4cbb-be16-7c2e6c9a45ff, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 160, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:27.401179+00, f, 52, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestPropagateOrderDiscountOnOrderLinesPrices" name="test_propagate_discount_zero_base_subtotal" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:27.833021+00, , , b8a70675-0e5b-4093-8d2c-f24ae0a5eb13, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 161, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:27.833695+00, f, 53, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:27.833021+00, , , b8a70675-0e5b-4093-8d2c-f24ae0a5eb13, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 161, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:27.833695+00, f, 53, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:647: in test_propagate_discount_zero_base_subtotal
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:27.833021+00, , , b8a70675-0e5b-4093-8d2c-f24ae0a5eb13, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 161, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:27.833695+00, f, 53, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestGetTotalPriceWithSubtotalDiscountForOrderLineFunction" name="test_get_total_price_finds_line" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:28.25571+00, , , f3bbb8a4-5e38-48e6-90b8-516215d9ad8d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 162, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:28.25671+00, f, 54, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:28.25571+00, , , f3bbb8a4-5e38-48e6-90b8-516215d9ad8d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 162, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:28.25671+00, f, 54, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:679: in test_get_total_price_finds_line
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:28.25571+00, , , f3bbb8a4-5e38-48e6-90b8-516215d9ad8d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 162, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:28.25671+00, f, 54, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestGetTotalPriceWithSubtotalDiscountForOrderLineFunction" name="test_get_total_price_line_not_found" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:28.902178+00, , , 1242434b-78c5-4ba9-a49e-806933eb367c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 163, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:28.903192+00, f, 55, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:28.902178+00, , , 1242434b-78c5-4ba9-a49e-806933eb367c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 163, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:28.903192+00, f, 55, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:705: in test_get_total_price_line_not_found
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:28.902178+00, , , 1242434b-78c5-4ba9-a49e-806933eb367c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 163, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:28.903192+00, f, 55, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestApplySubtotalDiscountToOrderLines" name="test_apply_subtotal_discount_calls_assign" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:29.332086+00, , , 9034f018-8fea-4629-bc5c-58322fbbdd66, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 164, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:29.333121+00, f, 56, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:29.332086+00, , , 9034f018-8fea-4629-bc5c-58322fbbdd66, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 164, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:29.333121+00, f, 56, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:743: in test_apply_subtotal_discount_calls_assign
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:29.332086+00, , , 9034f018-8fea-4629-bc5c-58322fbbdd66, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 164, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:29.333121+00, f, 56, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestAssignOrderLinePrices" name="test_assign_order_line_prices_positive_quantity" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:29.739926+00, , , 8f0893a1-a57c-4f03-b5d6-2be804905ee4, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 165, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:29.740574+00, f, 57, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:29.739926+00, , , 8f0893a1-a57c-4f03-b5d6-2be804905ee4, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 165, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:29.740574+00, f, 57, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:772: in test_assign_order_line_prices_positive_quantity
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:29.739926+00, , , 8f0893a1-a57c-4f03-b5d6-2be804905ee4, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 165, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:29.740574+00, f, 57, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestAssignOrderLinePrices" name="test_assign_order_line_prices_zero_quantity" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:30.183475+00, , , 8c442a63-4aac-4f53-a0e1-4d46e1a812b5, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 166, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:30.184149+00, f, 58, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:30.183475+00, , , 8c442a63-4aac-4f53-a0e1-4d46e1a812b5, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 166, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:30.184149+00, f, 58, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:798: in test_assign_order_line_prices_zero_quantity
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:30.183475+00, , , 8c442a63-4aac-4f53-a0e1-4d46e1a812b5, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 166, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:30.184149+00, f, 58, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestAssignOrderPrices" name="test_assign_order_prices_sets_all_fields" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:30.641501+00, , , 0868ad10-a608-4766-a464-132fc6b59c30, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 167, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:30.642569+00, f, 59, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:30.641501+00, , , 0868ad10-a608-4766-a464-132fc6b59c30, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 167, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:30.642569+00, f, 59, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:828: in test_assign_order_prices_sets_all_fields
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:30.641501+00, , , 0868ad10-a608-4766-a464-132fc6b59c30, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 167, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:30.642569+00, f, 59, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestUndiscountedOrderShipping" name="test_undiscounted_order_shipping_with_shipping_method" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;shipping_zone_id&quot; of relation &quot;shipping_shippingmethod&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (8, Standard, null, 0, , null, {}, {}, null, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (8, Standard, null, 0, , null, {}, {}, null, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:861: in test_undiscounted_order_shipping_with_shipping_method
    shipping_method = ShippingMethod.objects.create(name="Standard")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (8, Standard, null, 0, , null, {}, {}, null, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestUndiscountedOrderShipping" name="test_undiscounted_order_shipping_no_shipping_method" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:31.499554+00, , , b3d2aced-3ba7-4c39-8fdb-0347b233e792, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 169, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:31.500596+00, f, 60, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:31.499554+00, , , b3d2aced-3ba7-4c39-8fdb-0347b233e792, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 169, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:31.500596+00, f, 60, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:883: in test_undiscounted_order_shipping_no_shipping_method
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:31.499554+00, , , b3d2aced-3ba7-4c39-8fdb-0347b233e792, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 169, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:31.500596+00, f, 60, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestUndiscountedOrderShipping" name="test_undiscounted_order_shipping_no_listing" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;shipping_zone_id&quot; of relation &quot;shipping_shippingmethod&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (9, Standard, null, 0, , null, {}, {}, null, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (9, Standard, null, 0, , null, {}, {}, null, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:899: in test_undiscounted_order_shipping_no_listing
    shipping_method = ShippingMethod.objects.create(name="Standard")
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "shipping_zone_id" of relation "shipping_shippingmethod" violates not-null constraint
E   DETAIL:  Failing row contains (9, Standard, null, 0, , null, {}, {}, null, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestUndiscountedOrderSubtotal" name="test_undiscounted_order_subtotal_calculates_correctly" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:32.372701+00, , , 9703e0d1-c088-4ffb-ae23-76264a85d8dc, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 171, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:32.373325+00, f, 61, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:32.372701+00, , , 9703e0d1-c088-4ffb-ae23-76264a85d8dc, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 171, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:32.373325+00, f, 61, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:921: in test_undiscounted_order_subtotal_calculates_correctly
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:32.372701+00, , , 9703e0d1-c088-4ffb-ae23-76264a85d8dc, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 171, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:32.373325+00, f, 61, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_base_calculations_comprehensive.TestUndiscountedOrderTotal" name="test_undiscounted_order_total_sums_subtotal_and_shipping" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:32.798005+00, , , 95e27ba6-ea70-4855-860e-739efd7b5b8c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 172, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:32.798634+00, f, 62, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:32.798005+00, , , 95e27ba6-ea70-4855-860e-739efd7b5b8c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 172, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:32.798634+00, f, 62, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_base_calculations_comprehensive.py:947: in test_undiscounted_order_total_sums_subtotal_and_shipping
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:32.798005+00, , , 95e27ba6-ea70-4855-860e-739efd7b5b8c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 172, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:32.798634+00, f, 62, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredStatementCoverage" name="test_order_status_not_editable" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:33.241914+00, , , 2d6ee1a8-ee63-406e-bd1e-d8332c850303, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, fulfilled, null, null, t, , 0, , USD, {}, {}, 173, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:33.242622+00, f, 63, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:33.241914+00, , , 2d6ee1a8-ee63-406e-bd1e-d8332c850303, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, fulfilled, null, null, t, , 0, , USD, {}, {}, 173, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:33.242622+00, f, 63, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:36: in test_order_status_not_editable
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:33.241914+00, , , 2d6ee1a8-ee63-406e-bd1e-d8332c850303, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, fulfilled, null, null, t, , 0, , USD, {}, {}, 173, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:33.242622+00, f, 63, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredStatementCoverage" name="test_no_force_update_no_refresh_no_expired" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:33.652584+00, , , 7b6b5279-92f9-48ad-95f4-a27b94e5c280, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 174, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:33.653631+00, f, 64, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:33.652584+00, , , 7b6b5279-92f9-48ad-95f4-a27b94e5c280, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 174, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:33.653631+00, f, 64, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:58: in test_no_force_update_no_refresh_no_expired
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:33.652584+00, , , 7b6b5279-92f9-48ad-95f4-a27b94e5c280, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 174, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:33.653631+00, f, 64, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredStatementCoverage" name="test_tax_strategy_tax_app_no_sync_webhooks" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:34.065539+00, , , 2dd7b427-5373-4e7b-89ed-bb902c143167, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 175, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:34.066177+00, f, 65, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:34.065539+00, , , 2dd7b427-5373-4e7b-89ed-bb902c143167, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 175, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:34.066177+00, f, 65, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:81: in test_tax_strategy_tax_app_no_sync_webhooks
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:34.065539+00, , , 2dd7b427-5373-4e7b-89ed-bb902c143167, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 175, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:34.066177+00, f, 65, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredStatementCoverage" name="test_expired_line_ids_exists" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:34.490084+00, , , 15037f60-a649-4164-80bc-4d1c046ff546, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 176, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:34.490736+00, f, 66, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:34.490084+00, , , 15037f60-a649-4164-80bc-4d1c046ff546, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 176, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:34.490736+00, f, 66, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:106: in test_expired_line_ids_exists
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:34.490084+00, , , 15037f60-a649-4164-80bc-4d1c046ff546, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 176, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:34.490736+00, f, 66, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredStatementCoverage" name="test_no_expired_line_ids" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:34.896253+00, , , 1e96b12a-3cfe-413d-98dd-d289f3690c8b, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 177, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:34.896903+00, f, 67, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:34.896253+00, , , 1e96b12a-3cfe-413d-98dd-d289f3690c8b, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 177, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:34.896903+00, f, 67, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:138: in test_no_expired_line_ids
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:34.896253+00, , , 1e96b12a-3cfe-413d-98dd-d289f3690c8b, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 177, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:34.896903+00, f, 67, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredDecisionCoverage" name="test_decision_order_status_editable_true" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:35.346421+00, , , 834b8008-d1c0-4d33-a2e2-c10b395a5af1, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 178, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:35.347053+00, f, 68, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:35.346421+00, , , 834b8008-d1c0-4d33-a2e2-c10b395a5af1, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 178, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:35.347053+00, f, 68, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:177: in test_decision_order_status_editable_true
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:35.346421+00, , , 834b8008-d1c0-4d33-a2e2-c10b395a5af1, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 178, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:35.347053+00, f, 68, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredDecisionCoverage" name="test_decision_order_status_editable_false" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:36.028504+00, , , d3664093-897e-4be9-b6d1-6b31b5f6d087, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, canceled, null, null, t, , 0, , USD, {}, {}, 179, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:36.029294+00, f, 69, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:36.028504+00, , , d3664093-897e-4be9-b6d1-6b31b5f6d087, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, canceled, null, null, t, , 0, , USD, {}, {}, 179, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:36.029294+00, f, 69, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:205: in test_decision_order_status_editable_false
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:36.028504+00, , , d3664093-897e-4be9-b6d1-6b31b5f6d087, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, canceled, null, null, t, , 0, , USD, {}, {}, 179, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:36.029294+00, f, 69, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredDecisionCoverage" name="test_decision_force_update_true" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:36.435142+00, , , 84613000-8ba1-4875-af93-eff643b95682, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 180, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:36.435793+00, f, 70, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:36.435142+00, , , 84613000-8ba1-4875-af93-eff643b95682, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 180, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:36.435793+00, f, 70, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:228: in test_decision_force_update_true
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:36.435142+00, , , 84613000-8ba1-4875-af93-eff643b95682, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 180, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:36.435793+00, f, 70, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredDecisionCoverage" name="test_decision_force_update_false_should_refresh_true" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:36.837414+00, , , 994bff3c-0435-426d-b438-5b0274069e0c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 181, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:36.838125+00, f, 71, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:36.837414+00, , , 994bff3c-0435-426d-b438-5b0274069e0c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 181, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:36.838125+00, f, 71, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:257: in test_decision_force_update_false_should_refresh_true
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:36.837414+00, , , 994bff3c-0435-426d-b438-5b0274069e0c, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 181, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:36.838125+00, f, 71, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredDecisionCoverage" name="test_decision_expired_line_ids_exists_true" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:37.247104+00, , , 9ca65c0e-17ed-4352-ab18-8241a6de7301, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 182, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:37.247797+00, f, 72, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:37.247104+00, , , 9ca65c0e-17ed-4352-ab18-8241a6de7301, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 182, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:37.247797+00, f, 72, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:286: in test_decision_expired_line_ids_exists_true
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:37.247104+00, , , 9ca65c0e-17ed-4352-ab18-8241a6de7301, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 182, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:37.247797+00, f, 72, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredDecisionCoverage" name="test_decision_expired_line_ids_exists_false" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:37.649105+00, , , 6df7a407-068f-4db7-8249-00f1a3f6cead, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 183, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:37.649745+00, f, 73, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:37.649105+00, , , 6df7a407-068f-4db7-8249-00f1a3f6cead, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 183, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:37.649745+00, f, 73, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:317: in test_decision_expired_line_ids_exists_false
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:37.649105+00, , , 6df7a407-068f-4db7-8249-00f1a3f6cead, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 183, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:37.649745+00, f, 73, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredMCDC" name="test_mcdc_condition_force_update_true" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:38.062638+00, , , e4999124-ddf6-4dcb-957c-1a9be3d4e7bb, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 184, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:38.063289+00, f, 74, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:38.062638+00, , , e4999124-ddf6-4dcb-957c-1a9be3d4e7bb, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 184, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:38.063289+00, f, 74, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:355: in test_mcdc_condition_force_update_true
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:38.062638+00, , , e4999124-ddf6-4dcb-957c-1a9be3d4e7bb, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 184, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:38.063289+00, f, 74, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredMCDC" name="test_mcdc_condition_should_refresh_true" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:38.513029+00, , , 3c5b1b76-856e-4358-92a8-077f9c279aaa, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 185, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:38.513884+00, f, 75, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:38.513029+00, , , 3c5b1b76-856e-4358-92a8-077f9c279aaa, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 185, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:38.513884+00, f, 75, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:384: in test_mcdc_condition_should_refresh_true
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:38.513029+00, , , 3c5b1b76-856e-4358-92a8-077f9c279aaa, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 185, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:38.513884+00, f, 75, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredMCDC" name="test_mcdc_condition_expired_line_ids_true" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:38.940561+00, , , 774d8872-e81f-4627-9dcc-27ca1beeebbf, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 186, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:38.941622+00, f, 76, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:38.940561+00, , , 774d8872-e81f-4627-9dcc-27ca1beeebbf, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 186, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:38.941622+00, f, 76, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:413: in test_mcdc_condition_expired_line_ids_true
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:38.940561+00, , , 774d8872-e81f-4627-9dcc-27ca1beeebbf, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 186, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:38.941622+00, f, 76, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations.TestFetchOrderPricesIfExpiredMCDC" name="test_mcdc_condition_all_false" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:39.358033+00, , , ed5ccdc7-d6cf-458a-af3b-eba2013dd7db, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 187, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:39.358644+00, f, 77, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:39.358033+00, , , ed5ccdc7-d6cf-458a-af3b-eba2013dd7db, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 187, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:39.358644+00, f, 77, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations.py:444: in test_mcdc_condition_all_false
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:39.358033+00, , , ed5ccdc7-d6cf-458a-af3b-eba2013dd7db, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 187, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:39.358644+00, f, 77, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestGetExpiredLineIds" name="test_get_expired_line_ids_returns_empty_for_non_draft" time="0.006"><failure message="AttributeError: type object 'OrderStatus' has no attribute 'CONFIRMED'. Did you mean: 'UNCONFIRMED'?">tests/whitebox/test_order_calculations_comprehensive.py:59: in test_get_expired_line_ids_returns_empty_for_non_draft
    status=OrderStatus.CONFIRMED,
           ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: type object 'OrderStatus' has no attribute 'CONFIRMED'. Did you mean: 'UNCONFIRMED'?</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestGetExpiredLineIds" name="test_get_expired_line_ids_returns_expired_lines" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product 1, SKU1, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant 1, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 5eef3601-4f53-472e-b0de-d550b30986ba, 5307c2b2-83e4-4a70-81c8-9a550019ad37, null, 2025-12-07 13:26:39.804631+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, 2025-12-06 13:26:39.804158+00, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product 1, SKU1, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant 1, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 5eef3601-4f53-472e-b0de-d550b30986ba, 5307c2b2-83e4-4a70-81c8-9a550019ad37, null, 2025-12-07 13:26:39.804631+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, 2025-12-06 13:26:39.804158+00, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations_comprehensive.py:83: in test_get_expired_line_ids_returns_expired_lines
    line1 = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product 1, SKU1, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant 1, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 5eef3601-4f53-472e-b0de-d550b30986ba, 5307c2b2-83e4-4a70-81c8-9a550019ad37, null, 2025-12-07 13:26:39.804631+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, 2025-12-06 13:26:39.804158+00, null).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestGetExpiredLineIds" name="test_get_expired_line_ids_uses_provided_lines" time="0.011"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product 1, SKU1, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant 1, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 7b513199-183e-42b2-91e1-17ff5993907c, 3397bde6-c19e-4769-9b26-fee2c1cfa4bd, null, 2025-12-07 13:26:40.262859+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, 2025-12-06 13:26:40.261995+00, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product 1, SKU1, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant 1, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 7b513199-183e-42b2-91e1-17ff5993907c, 3397bde6-c19e-4769-9b26-fee2c1cfa4bd, null, 2025-12-07 13:26:40.262859+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, 2025-12-06 13:26:40.261995+00, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations_comprehensive.py:126: in test_get_expired_line_ids_uses_provided_lines
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product 1, SKU1, 1, 10.000, 10.000, null, 0, null, null, , USD, , Variant 1, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 7b513199-183e-42b2-91e1-17ff5993907c, 3397bde6-c19e-4769-9b26-fee2c1cfa4bd, null, 2025-12-07 13:26:40.262859+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, 2025-12-06 13:26:40.261995+00, null).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestFetchOrderPricesIfExpired" name="test_fetch_order_prices_returns_early_for_non_editable_status" time="0.010" /><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestFetchOrderPricesIfExpired" name="test_fetch_order_prices_returns_early_when_not_expired" time="0.013" /><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestFetchOrderPricesIfExpired" name="test_fetch_order_prices_refreshes_when_force_update" time="0.012"><failure message="saleor.channel.models.Channel.tax_configuration.RelatedObjectDoesNotExist: Channel has no tax_configuration.">tests/whitebox/test_order_calculations_comprehensive.py:214: in test_fetch_order_prices_refreshes_when_force_update
    result_order, result_lines = fetch_order_prices_if_expired(
saleor/order/calculations.py:82: in fetch_order_prices_if_expired
    tax_strategy = get_tax_calculation_strategy_for_order(order)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/tax/utils.py:140: in get_tax_calculation_strategy_for_order
    tax_configuration, country_tax_configuration = _get_tax_configuration_for_order(
saleor/tax/utils.py:113: in _get_tax_configuration_for_order
    tax_configuration = channel.tax_configuration
                        ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/fields/related_descriptors.py:534: in __get__
    raise self.RelatedObjectDoesNotExist(
E   saleor.channel.models.Channel.tax_configuration.RelatedObjectDoesNotExist: Channel has no tax_configuration.</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestCalculateTaxes" name="test_calculate_taxes_with_prices_entered_with_tax" time="0.006"><failure message="saleor.channel.models.Channel.tax_configuration.RelatedObjectDoesNotExist: Channel has no tax_configuration.">tests/whitebox/test_order_calculations_comprehensive.py:232: in test_calculate_taxes_with_prices_entered_with_tax
    channel.tax_configuration.prices_entered_with_tax = True
    ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/fields/related_descriptors.py:534: in __get__
    raise self.RelatedObjectDoesNotExist(
E   saleor.channel.models.Channel.tax_configuration.RelatedObjectDoesNotExist: Channel has no tax_configuration.</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestCalculateTaxes" name="test_calculate_taxes_removes_tax_when_exempt" time="0.007"><failure message="saleor.channel.models.Channel.tax_configuration.RelatedObjectDoesNotExist: Channel has no tax_configuration.">tests/whitebox/test_order_calculations_comprehensive.py:260: in test_calculate_taxes_removes_tax_when_exempt
    channel.tax_configuration.prices_entered_with_tax = True
    ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/fields/related_descriptors.py:534: in __get__
    raise self.RelatedObjectDoesNotExist(
E   saleor.channel.models.Channel.tax_configuration.RelatedObjectDoesNotExist: Channel has no tax_configuration.</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestCalculateTaxes" name="test_calculate_taxes_with_prices_without_tax" time="0.006"><failure message="saleor.channel.models.Channel.tax_configuration.RelatedObjectDoesNotExist: Channel has no tax_configuration.">tests/whitebox/test_order_calculations_comprehensive.py:287: in test_calculate_taxes_with_prices_without_tax
    channel.tax_configuration.prices_entered_with_tax = False
    ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/fields/related_descriptors.py:534: in __get__
    raise self.RelatedObjectDoesNotExist(
E   saleor.channel.models.Channel.tax_configuration.RelatedObjectDoesNotExist: Channel has no tax_configuration.</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestRemoveTax" name="test_remove_tax_calls_remove_tax_gross_when_prices_with_tax" time="0.008"><failure message="AssertionError: Expected '_remove_tax_gross' to have been called once. Called 0 times.">tests/whitebox/test_order_calculations_comprehensive.py:331: in test_remove_tax_calls_remove_tax_gross_when_prices_with_tax
    mock_remove.assert_called_once()
/usr/lib/python3.12/unittest/mock.py:923: in assert_called_once
    raise AssertionError(msg)
E   AssertionError: Expected '_remove_tax_gross' to have been called once. Called 0 times.</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestRemoveTax" name="test_remove_tax_calls_remove_tax_net_when_prices_without_tax" time="0.008"><failure message="AssertionError: Expected '_remove_tax_net' to have been called once. Called 0 times.">tests/whitebox/test_order_calculations_comprehensive.py:350: in test_remove_tax_calls_remove_tax_net_when_prices_without_tax
    mock_remove.assert_called_once()
/usr/lib/python3.12/unittest/mock.py:923: in assert_called_once
    raise AssertionError(msg)
E   AssertionError: Expected '_remove_tax_net' to have been called once. Called 0 times.</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestOrderLineUnit" name="test_order_line_unit_returns_unit_price" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;is_shipping_required&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 2, 10.000, 12.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, ee3ad14f-14bc-43df-9c59-1ff7c8591250, df943438-84cc-4084-8716-457f47437bba, null, 2025-12-07 13:26:41.25085+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 2, 10.000, 12.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, ee3ad14f-14bc-43df-9c59-1ff7c8591250, df943438-84cc-4084-8716-457f47437bba, null, 2025-12-07 13:26:41.25085+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations_comprehensive.py:370: in test_order_line_unit_returns_unit_price
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "is_shipping_required" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 2, 10.000, 12.000, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, ee3ad14f-14bc-43df-9c59-1ff7c8591250, df943438-84cc-4084-8716-457f47437bba, null, 2025-12-07 13:26:41.25085+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestOrderLineTotal" name="test_order_line_total_returns_total_price" time="0.011"><failure message="django.db.utils.IntegrityError: null value in column &quot;unit_price_net_amount&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 2, null, null, null, 0, null, null, , USD, , Variant, 24.000, 20.000, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, d5d403aa-a9d0-4eab-a662-f2c49b0be13f, ea8f0e30-b66b-47c7-8282-425a75a77afc, null, 2025-12-07 13:26:41.894097+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "unit_price_net_amount" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 2, null, null, null, 0, null, null, , USD, , Variant, 24.000, 20.000, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, d5d403aa-a9d0-4eab-a662-f2c49b0be13f, ea8f0e30-b66b-47c7-8282-425a75a77afc, null, 2025-12-07 13:26:41.894097+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations_comprehensive.py:404: in test_order_line_total_returns_total_price
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "unit_price_net_amount" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 2, null, null, null, 0, null, null, , USD, , Variant, 24.000, 20.000, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, d5d403aa-a9d0-4eab-a662-f2c49b0be13f, ea8f0e30-b66b-47c7-8282-425a75a77afc, null, 2025-12-07 13:26:41.894097+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestOrderLineTaxRate" name="test_order_line_tax_rate_returns_tax_rate" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;unit_price_net_amount&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, null, null, null, 0, null, 0.2000, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, a3867db7-f861-4d53-b48d-2affbed9cc00, 32f30d95-8121-4f15-9c6a-4e8eebf78bb2, null, 2025-12-07 13:26:42.399576+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "unit_price_net_amount" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, null, null, null, 0, null, 0.2000, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, a3867db7-f861-4d53-b48d-2affbed9cc00, 32f30d95-8121-4f15-9c6a-4e8eebf78bb2, null, 2025-12-07 13:26:42.399576+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations_comprehensive.py:438: in test_order_line_tax_rate_returns_tax_rate
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "unit_price_net_amount" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, null, null, null, 0, null, 0.2000, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, a3867db7-f861-4d53-b48d-2affbed9cc00, 32f30d95-8121-4f15-9c6a-4e8eebf78bb2, null, 2025-12-07 13:26:42.399576+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestOrderLineTaxRate" name="test_order_line_tax_rate_returns_zero_when_none" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;unit_price_net_amount&quot; of relation &quot;order_orderline&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (Product, SKU, 1, null, null, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 72f31dec-f0f0-493d-8b8f-081b2c9f3b8a, a9a1ab32-4b6d-4535-8c28-c95e561972ff, null, 2025-12-07 13:26:42.822272+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "unit_price_net_amount" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, null, null, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 72f31dec-f0f0-493d-8b8f-081b2c9f3b8a, a9a1ab32-4b6d-4535-8c28-c95e561972ff, null, 2025-12-07 13:26:42.822272+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_calculations_comprehensive.py:465: in test_order_line_tax_rate_returns_zero_when_none
    line = OrderLine.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "unit_price_net_amount" of relation "order_orderline" violates not-null constraint
E   DETAIL:  Failing row contains (Product, SKU, 1, null, null, null, 0, null, null, , USD, , Variant, null, null, 0.000, 0.000, null, null, 0.000, 0.000, 0.000, 0.000, null, null, null, null, 72f31dec-f0f0-493d-8b8f-081b2c9f3b8a, a9a1ab32-4b6d-4535-8c28-c95e561972ff, null, 2025-12-07 13:26:42.822272+00, 0.000, 0.000, {}, {}, null, {}, null, {}, f, null, null, null).</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestOrderSubtotal" name="test_order_subtotal_returns_subtotal_from_order" time="0.008"><failure message="TypeError: order_subtotal() missing 1 required positional argument: 'manager'">tests/whitebox/test_order_calculations_comprehensive.py:500: in test_order_subtotal_returns_subtotal_from_order
    result = order_subtotal(order)
             ^^^^^^^^^^^^^^^^^^^^^
E   TypeError: order_subtotal() missing 1 required positional argument: 'manager'</failure></testcase><testcase classname="tests.whitebox.test_order_calculations_comprehensive.TestOrderTotal" name="test_order_total_returns_total_from_order" time="0.008"><failure message="TypeError: order_total() missing 1 required positional argument: 'manager'">tests/whitebox/test_order_calculations_comprehensive.py:526: in test_order_total_returns_total_from_order
    result = order_total(order)
             ^^^^^^^^^^^^^^^^^^
E   TypeError: order_total() missing 1 required positional argument: 'manager'</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestGetOrderCountry" name="test_get_order_country_uses_shipping_address" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:43.499042+00, , , 7befa9f2-9657-4434-aea4-2d8a2ceb199e, null, 6, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 205, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:43.499717+00, f, 91, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:43.499042+00, , , 7befa9f2-9657-4434-aea4-2d8a2ceb199e, null, 6, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 205, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:43.499717+00, f, 91, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:72: in test_get_order_country_uses_shipping_address
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:43.499042+00, , , 7befa9f2-9657-4434-aea4-2d8a2ceb199e, null, 6, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 205, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:43.499717+00, f, 91, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestOrderLineNeedsAutomaticFulfillment" name="test_order_line_needs_automatic_fulfillment_no_digital_content" time="0.005"><failure message="django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.">tests/whitebox/test_order_utils_comprehensive.py:96: in test_order_line_needs_automatic_fulfillment_no_digital_content
    result = order_line_needs_automatic_fulfillment(line_data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/order/utils.py:101: in order_line_needs_automatic_fulfillment
    digital_content_settings = get_default_digital_content_settings()
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/product/utils/digital_products.py:12: in get_default_digital_content_settings
    site = Site.objects.get_current()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/site/patch_sites.py:29: in new_get_current
    self.prefetch_related("settings")
.venv/lib/python3.12/site-packages/django/db/models/query.py:437: in __getitem__
    qs._fetch_all()
.venv/lib/python3.12/site-packages/django/db/models/query.py:1954: in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:93: in __iter__
    results = compiler.execute_sql(
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1621: in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/test/testcases.py:201: in __call__
    raise DatabaseOperationForbidden(self.message)
E   django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestOrderLineNeedsAutomaticFulfillment" name="test_order_line_needs_automatic_fulfillment_default_settings_true" time="0.005" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestOrderLineNeedsAutomaticFulfillment" name="test_order_line_needs_automatic_fulfillment_default_settings_false" time="0.004" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestOrderLineNeedsAutomaticFulfillment" name="test_order_line_needs_automatic_fulfillment_content_automatic_true" time="0.004" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestOrderNeedsAutomaticFulfillment" name="test_order_needs_automatic_fulfillment_no_digital_lines" time="0.005" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestOrderNeedsAutomaticFulfillment" name="test_order_needs_automatic_fulfillment_digital_line_needs_fulfillment" time="0.005" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestInvalidateOrderPrices" name="test_invalidate_order_prices_editable_status" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:44.22791+00, , , 5dca7134-3471-4f7f-a5c5-4bb7043e356a, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 206, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:44.228525+00, f, 92, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:44.22791+00, , , 5dca7134-3471-4f7f-a5c5-4bb7043e356a, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 206, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:44.228525+00, f, 92, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:179: in test_invalidate_order_prices_editable_status
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:44.22791+00, , , 5dca7134-3471-4f7f-a5c5-4bb7043e356a, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 206, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:44.228525+00, f, 92, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestInvalidateOrderPrices" name="test_invalidate_order_prices_non_editable_status" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:44.654879+00, , , 58f81406-e212-4c1c-8983-4885cffd657a, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, fulfilled, null, null, t, , 0, , USD, {}, {}, 207, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:44.65557+00, f, 93, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:44.654879+00, , , 58f81406-e212-4c1c-8983-4885cffd657a, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, fulfilled, null, null, t, , 0, , USD, {}, {}, 207, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:44.65557+00, f, 93, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:195: in test_invalidate_order_prices_non_editable_status
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:44.654879+00, , , 58f81406-e212-4c1c-8983-4885cffd657a, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, fulfilled, null, null, t, , 0, , USD, {}, {}, 207, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:44.65557+00, f, 93, null, 0.000, none, none, null, f, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestInvalidateOrderPrices" name="test_invalidate_order_prices_with_save" time="0.010"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:45.095443+00, , , 28606114-153a-46f1-ad8a-4abc63d305e8, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 208, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:45.096656+00, f, 94, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:45.095443+00, , , 28606114-153a-46f1-ad8a-4abc63d305e8, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 208, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:45.096656+00, f, 94, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:213: in test_invalidate_order_prices_with_save
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:45.095443+00, , , 28606114-153a-46f1-ad8a-4abc63d305e8, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, draft, null, null, t, , 0, , USD, {}, {}, 208, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:45.096656+00, f, 94, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestRecalculateOrderWeight" name="test_recalculate_order_weight_sums_line_weights" time="0.014"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:45.634887+00, , , 2f37b799-f843-4e04-b146-67eaadab9d08, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 209, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:45.63626+00, f, 95, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:45.634887+00, , , 2f37b799-f843-4e04-b146-67eaadab9d08, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 209, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:45.63626+00, f, 95, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:235: in test_recalculate_order_weight_sums_line_weights
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:45.634887+00, , , 2f37b799-f843-4e04-b146-67eaadab9d08, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 209, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:45.63626+00, f, 95, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestDetermineOrderStatus" name="test_determine_order_status_unfulfilled" time="0.005" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestDetermineOrderStatus" name="test_determine_order_status_unfulfilled_with_awaiting" time="0.005" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestDetermineOrderStatus" name="test_determine_order_status_partially_returned" time="0.005" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestDetermineOrderStatus" name="test_determine_order_status_returned" time="0.005" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestDetermineOrderStatus" name="test_determine_order_status_partially_fulfilled" time="0.004" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestDetermineOrderStatus" name="test_determine_order_status_fulfilled" time="0.004" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestRefreshOrderStatus" name="test_refresh_order_status_all_products_replaced" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:46.469917+00, , , 8e68b771-46a8-4cd9-b5a0-e430ff0cc217, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 210, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:46.470655+00, f, 96, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:46.469917+00, , , 8e68b771-46a8-4cd9-b5a0-e430ff0cc217, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 210, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:46.470655+00, f, 96, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:347: in test_refresh_order_status_all_products_replaced
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:46.469917+00, , , 8e68b771-46a8-4cd9-b5a0-e430ff0cc217, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 210, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:46.470655+00, f, 96, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestRefreshOrderStatus" name="test_refresh_order_status_status_changes" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:46.977241+00, , , 97177e04-eafb-4c78-94a1-bd0a1b4dcd58, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 211, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:46.977905+00, f, 97, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:46.977241+00, , , 97177e04-eafb-4c78-94a1-bd0a1b4dcd58, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 211, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:46.977905+00, f, 97, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:378: in test_refresh_order_status_status_changes
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:46.977241+00, , , 97177e04-eafb-4c78-94a1-bd0a1b4dcd58, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 211, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:46.977905+00, f, 97, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderStatus" name="test_update_order_status_with_transaction" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:47.406239+00, , , cb318b8e-3a16-438b-86b6-64f7f2f6a2c6, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 212, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:47.406918+00, f, 98, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:47.406239+00, , , cb318b8e-3a16-438b-86b6-64f7f2f6a2c6, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 212, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:47.406918+00, f, 98, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:407: in test_update_order_status_with_transaction
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:47.406239+00, , , cb318b8e-3a16-438b-86b6-64f7f2f6a2c6, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 212, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:47.406918+00, f, 98, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestGetTotalOrderDiscount" name="test_get_total_order_discount_sums_all_discounts" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:47.831773+00, , , 9c515caa-1bff-4313-b047-de5a4324e6b9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 213, null, null, 100.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:47.832428+00, f, 99, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:47.831773+00, , , 9c515caa-1bff-4313-b047-de5a4324e6b9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 213, null, null, 100.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:47.832428+00, f, 99, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:433: in test_get_total_order_discount_sums_all_discounts
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:47.831773+00, , , 9c515caa-1bff-4313-b047-de5a4324e6b9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 213, null, null, 100.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:47.832428+00, f, 99, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestGetTotalOrderDiscount" name="test_get_total_order_discount_caps_at_undiscounted_total" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:48.256671+00, , , 85be0071-b62c-41b8-b85b-d9b3aded9af2, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 214, null, null, 10.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:48.257303+00, f, 100, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:48.256671+00, , , 85be0071-b62c-41b8-b85b-d9b3aded9af2, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 214, null, null, 10.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:48.257303+00, f, 100, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:466: in test_get_total_order_discount_caps_at_undiscounted_total
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:48.256671+00, , , 85be0071-b62c-41b8-b85b-d9b3aded9af2, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 214, null, null, 10.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:48.257303+00, f, 100, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestGetTotalOrderDiscountExcludingShipping" name="test_get_total_order_discount_excluding_shipping_no_shipping_voucher" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:48.676519+00, , , dbabf802-04a7-429a-89fb-a5bb179f6bea, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 215, null, null, 100.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:48.677212+00, f, 101, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:48.676519+00, , , dbabf802-04a7-429a-89fb-a5bb179f6bea, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 215, null, null, 100.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:48.677212+00, f, 101, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:496: in test_get_total_order_discount_excluding_shipping_no_shipping_voucher
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:48.676519+00, , , dbabf802-04a7-429a-89fb-a5bb179f6bea, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 215, null, null, 100.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:48.677212+00, f, 101, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestGetTotalOrderDiscountExcludingShipping" name="test_get_total_order_discount_excluding_shipping_with_shipping_voucher" time="0.006"><failure message="ValueError: Cannot assign &quot;&lt;Mock id='125654012370128'&gt;&quot;: &quot;Order.voucher&quot; must be a &quot;Voucher&quot; instance.">tests/whitebox/test_order_utils_comprehensive.py:524: in test_get_total_order_discount_excluding_shipping_with_shipping_voucher
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:545: in __init__
    _setattr(self, field.name, rel_obj)
.venv/lib/python3.12/site-packages/django/db/models/fields/related_descriptors.py:291: in __set__
    raise ValueError(
E   ValueError: Cannot assign "&lt;Mock id='125654012370128'&gt;": "Order.voucher" must be a "Voucher" instance.</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderChargeStatus" name="test_update_order_charge_status_full" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:49.276056+00, , , 4f3994b7-6527-41d4-abed-4e38adef068e, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 217, null, null, 0.000, 0.000, 100.000, , null, null, , 2025-12-07 13:26:49.276734+00, f, 103, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:49.276056+00, , , 4f3994b7-6527-41d4-abed-4e38adef068e, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 217, null, null, 0.000, 0.000, 100.000, , null, null, , 2025-12-07 13:26:49.276734+00, f, 103, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:563: in test_update_order_charge_status_full
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:49.276056+00, , , 4f3994b7-6527-41d4-abed-4e38adef068e, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 217, null, null, 0.000, 0.000, 100.000, , null, null, , 2025-12-07 13:26:49.276734+00, f, 103, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderChargeStatus" name="test_update_order_charge_status_none" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:49.70255+00, , , 8ce1822c-6b63-496b-bcc2-592eabd1a484, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 218, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:49.703262+00, f, 104, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:49.70255+00, , , 8ce1822c-6b63-496b-bcc2-592eabd1a484, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 218, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:49.703262+00, f, 104, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:580: in test_update_order_charge_status_none
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:49.70255+00, , , 8ce1822c-6b63-496b-bcc2-592eabd1a484, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 218, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:49.703262+00, f, 104, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderChargeStatus" name="test_update_order_charge_status_partial" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:50.145943+00, , , 9070ccd7-26da-4c77-be7c-1ea71cf84384, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 219, null, null, 0.000, 0.000, 50.000, , null, null, , 2025-12-07 13:26:50.146638+00, f, 105, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:50.145943+00, , , 9070ccd7-26da-4c77-be7c-1ea71cf84384, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 219, null, null, 0.000, 0.000, 50.000, , null, null, , 2025-12-07 13:26:50.146638+00, f, 105, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:597: in test_update_order_charge_status_partial
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:50.145943+00, , , 9070ccd7-26da-4c77-be7c-1ea71cf84384, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 219, null, null, 0.000, 0.000, 50.000, , null, null, , 2025-12-07 13:26:50.146638+00, f, 105, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderChargeStatus" name="test_update_order_charge_status_overcharged" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:50.595443+00, , , cafabe15-57f7-4203-9d0f-b6b24c1524bb, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 220, null, null, 0.000, 0.000, 150.000, , null, null, , 2025-12-07 13:26:50.596128+00, f, 106, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:50.595443+00, , , cafabe15-57f7-4203-9d0f-b6b24c1524bb, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 220, null, null, 0.000, 0.000, 150.000, , null, null, , 2025-12-07 13:26:50.596128+00, f, 106, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:614: in test_update_order_charge_status_overcharged
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:50.595443+00, , , cafabe15-57f7-4203-9d0f-b6b24c1524bb, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 220, null, null, 0.000, 0.000, 150.000, , null, null, , 2025-12-07 13:26:50.596128+00, f, 106, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderChargeStatus" name="test_update_order_charge_status_with_granted_refund" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:51.225336+00, , , cc26bf51-8cd1-426a-bff7-f865f4a8af0f, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 221, null, null, 0.000, 0.000, 80.000, , null, null, , 2025-12-07 13:26:51.226081+00, f, 107, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:51.225336+00, , , cc26bf51-8cd1-426a-bff7-f865f4a8af0f, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 221, null, null, 0.000, 0.000, 80.000, , null, null, , 2025-12-07 13:26:51.226081+00, f, 107, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:631: in test_update_order_charge_status_with_granted_refund
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:51.225336+00, , , cc26bf51-8cd1-426a-bff7-f865f4a8af0f, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 221, null, null, 0.000, 0.000, 80.000, , null, null, , 2025-12-07 13:26:51.226081+00, f, 107, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderAuthorizeStatus" name="test_update_order_authorize_status_full_zero_total" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:51.640921+00, , , 38fd6c1c-d618-43cf-95a9-c4bdffd4ba2d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 222, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:51.641574+00, f, 108, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:51.640921+00, , , 38fd6c1c-d618-43cf-95a9-c4bdffd4ba2d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 222, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:51.641574+00, f, 108, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:654: in test_update_order_authorize_status_full_zero_total
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:51.640921+00, , , 38fd6c1c-d618-43cf-95a9-c4bdffd4ba2d, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 222, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:51.641574+00, f, 108, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderAuthorizeStatus" name="test_update_order_authorize_status_none" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:52.064971+00, , , 94373a5b-3edd-4c0c-b3a9-9466b631889b, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 223, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:52.06562+00, f, 109, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:52.064971+00, , , 94373a5b-3edd-4c0c-b3a9-9466b631889b, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 223, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:52.06562+00, f, 109, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:672: in test_update_order_authorize_status_none
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:52.064971+00, , , 94373a5b-3edd-4c0c-b3a9-9466b631889b, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 223, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:52.06562+00, f, 109, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderAuthorizeStatus" name="test_update_order_authorize_status_full_covered" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:52.482338+00, , , 9ba700cb-adb3-4af3-8c1e-7edbe5cda385, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 224, null, null, 0.000, 0.000, 40.000, , null, null, , 2025-12-07 13:26:52.482989+00, f, 110, null, 60.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:52.482338+00, , , 9ba700cb-adb3-4af3-8c1e-7edbe5cda385, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 224, null, null, 0.000, 0.000, 40.000, , null, null, , 2025-12-07 13:26:52.482989+00, f, 110, null, 60.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:690: in test_update_order_authorize_status_full_covered
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:52.482338+00, , , 9ba700cb-adb3-4af3-8c1e-7edbe5cda385, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 224, null, null, 0.000, 0.000, 40.000, , null, null, , 2025-12-07 13:26:52.482989+00, f, 110, null, 60.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestUpdateOrderAuthorizeStatus" name="test_update_order_authorize_status_partial" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:52.915651+00, , , df75bd5c-cb6b-40af-880d-82bfd4befa97, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 225, null, null, 0.000, 0.000, 20.000, , null, null, , 2025-12-07 13:26:52.9167+00, f, 111, null, 30.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:52.915651+00, , , df75bd5c-cb6b-40af-880d-82bfd4befa97, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 225, null, null, 0.000, 0.000, 20.000, , null, null, , 2025-12-07 13:26:52.9167+00, f, 111, null, 30.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_order_utils_comprehensive.py:709: in test_update_order_authorize_status_partial
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:52.915651+00, , , df75bd5c-cb6b-40af-880d-82bfd4befa97, null, null, null, 0.000, null, en, 0.000, 100.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 225, null, null, 0.000, 0.000, 20.000, , null, null, , 2025-12-07 13:26:52.9167+00, f, 111, null, 30.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestCalculateDraftOrderLinePriceExpirationDate" name="test_calculate_draft_order_line_price_expiration_date_not_draft" time="0.007" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestCalculateDraftOrderLinePriceExpirationDate" name="test_calculate_draft_order_line_price_expiration_date_draft_no_freeze_period" time="0.007" /><testcase classname="tests.whitebox.test_order_utils_comprehensive.TestCalculateDraftOrderLinePriceExpirationDate" name="test_calculate_draft_order_line_price_expiration_date_draft_with_freeze_period" time="0.008" /><testcase classname="tests.whitebox.test_payment_utils.TestPaymentModel" name="test_payment_creation" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:53.377969+00, , , 7eeb1164-4530-4c7a-bd11-ded4270ce1c9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 229, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:53.378604+00, f, 112, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:53.377969+00, , , 7eeb1164-4530-4c7a-bd11-ded4270ce1c9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 229, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:53.378604+00, f, 112, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_payment_utils.py:33: in test_payment_creation
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:53.377969+00, , , 7eeb1164-4530-4c7a-bd11-ded4270ce1c9, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 229, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:53.378604+00, f, 112, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_payment_utils.TestPaymentModel" name="test_payment_captured_amount" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:53.78873+00, , , 8e9987ce-2ca9-4c03-9f81-3516c05cf05b, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 230, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:53.789431+00, f, 113, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:53.78873+00, , , 8e9987ce-2ca9-4c03-9f81-3516c05cf05b, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 230, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:53.789431+00, f, 113, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_payment_utils.py:59: in test_payment_captured_amount
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:53.78873+00, , , 8e9987ce-2ca9-4c03-9f81-3516c05cf05b, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 230, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:53.789431+00, f, 113, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_payment_utils.TestPaymentModel" name="test_payment_get_authorized" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:54.20052+00, , , 486edecc-0bf3-4568-955e-f396b6687473, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 231, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:54.201144+00, f, 114, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:54.20052+00, , , 486edecc-0bf3-4568-955e-f396b6687473, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 231, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:54.201144+00, f, 114, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_payment_utils.py:83: in test_payment_get_authorized
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:54.20052+00, , , 486edecc-0bf3-4568-955e-f396b6687473, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 231, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:54.201144+00, f, 114, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_payment_utils.TestTransactionModel" name="test_transaction_creation" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:54.626284+00, , , 5cfca331-df5c-47ef-ba2b-7a61b3829337, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 232, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:54.626945+00, f, 115, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:54.626284+00, , , 5cfca331-df5c-47ef-ba2b-7a61b3829337, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 232, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:54.626945+00, f, 115, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_payment_utils.py:123: in test_transaction_creation
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:54.626284+00, , , 5cfca331-df5c-47ef-ba2b-7a61b3829337, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 232, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:54.626945+00, f, 115, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_payment_utils.TestTransactionModel" name="test_transaction_failed" time="0.009"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:55.034685+00, , , 6f321554-1cc0-427f-bb16-c03897dc0e00, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 233, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:55.03577+00, f, 116, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:55.034685+00, , , 6f321554-1cc0-427f-bb16-c03897dc0e00, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 233, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:55.03577+00, f, 116, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_payment_utils.py:155: in test_transaction_failed
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:55.034685+00, , , 6f321554-1cc0-427f-bb16-c03897dc0e00, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 233, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:55.03577+00, f, 116, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_payment_utils.TestTransactionItemModel" name="test_transaction_item_creation" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:55.485841+00, , , f48a2f37-4f4e-4e56-b002-f0d01ace0497, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 234, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:55.486874+00, f, 117, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:55.485841+00, , , f48a2f37-4f4e-4e56-b002-f0d01ace0497, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 234, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:55.486874+00, f, 117, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_payment_utils.py:195: in test_transaction_item_creation
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:55.485841+00, , , f48a2f37-4f4e-4e56-b002-f0d01ace0497, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 234, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:55.486874+00, f, 117, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_payment_utils.TestTransactionItemModel" name="test_transaction_item_authorized_amount" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:55.920522+00, , , a5429b51-5836-4b31-b32b-c354c270ea43, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 235, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:55.921589+00, f, 118, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:55.920522+00, , , a5429b51-5836-4b31-b32b-c354c270ea43, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 235, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:55.921589+00, f, 118, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_payment_utils.py:219: in test_transaction_item_authorized_amount
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:55.920522+00, , , a5429b51-5836-4b31-b32b-c354c270ea43, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 235, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:55.921589+00, f, 118, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_payment_utils.TestTransactionItemModel" name="test_transaction_item_charged_amount" time="0.008"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:26:56.328748+00, , , 52277bbb-487d-4701-b373-6cc510c9ac13, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 236, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:56.329766+00, f, 119, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:56.328748+00, , , 52277bbb-487d-4701-b373-6cc510c9ac13, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 236, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:56.329766+00, f, 119, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_payment_utils.py:242: in test_transaction_item_charged_amount
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:26:56.328748+00, , , 52277bbb-487d-4701-b373-6cc510c9ac13, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 236, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:26:56.329766+00, f, 119, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreatePaymentLinesInformation" name="test_create_payment_lines_information_empty_lines" time="0.004"><failure message="TypeError: create_payment_lines_information() missing 1 required positional argument: 'manager'">tests/whitebox/test_payment_utils_additional.py:41: in test_create_payment_lines_information_empty_lines
    result = create_payment_lines_information(lines)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: create_payment_lines_information() missing 1 required positional argument: 'manager'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreatePaymentLinesInformation" name="test_create_payment_lines_information_with_lines" time="0.005"><failure message="TypeError: create_payment_lines_information() missing 1 required positional argument: 'manager'">tests/whitebox/test_payment_utils_additional.py:64: in test_create_payment_lines_information_with_lines
    result = create_payment_lines_information(lines)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: create_payment_lines_information() missing 1 required positional argument: 'manager'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreateCheckoutPaymentLinesInformation" name="test_create_checkout_payment_lines_information" time="0.007"><failure message="TypeError: create_checkout_payment_lines_information() missing 1 required positional argument: 'manager'">tests/whitebox/test_payment_utils_additional.py:86: in test_create_checkout_payment_lines_information
    result = create_checkout_payment_lines_information(checkout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: create_checkout_payment_lines_information() missing 1 required positional argument: 'manager'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreateOrderPaymentLinesInformation" name="test_create_order_payment_lines_information" time="0.010"><failure message="AssertionError: assert False&#10; +  where False = isinstance(PaymentLinesData(shipping_amount=Decimal('0.0'), voucher_amount=Decimal('0.0'), lines=[]), list)">tests/whitebox/test_payment_utils_additional.py:109: in test_create_order_payment_lines_information
    assert isinstance(result, list)
E   AssertionError: assert False
E    +  where False = isinstance(PaymentLinesData(shipping_amount=Decimal('0.0'), voucher_amount=Decimal('0.0'), lines=[]), list)</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestGenerateTransactionsData" name="test_generate_transactions_data_empty" time="0.008" /><testcase classname="tests.whitebox.test_payment_utils_additional.TestGenerateTransactionsData" name="test_generate_transactions_data_with_transactions" time="0.007"><failure message="TypeError: TransactionItem() got unexpected keyword arguments: 'payment', 'amount_value'">tests/whitebox/test_payment_utils_additional.py:148: in test_generate_transactions_data_with_transactions
    transaction = TransactionItem.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: TransactionItem() got unexpected keyword arguments: 'payment', 'amount_value'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreatePaymentInformation" name="test_create_payment_information_with_payment" time="0.008" /><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreatePaymentInformation" name="test_create_payment_information_with_checkout" time="0.008"><failure message="TypeError: create_payment_information() got an unexpected keyword argument 'customer_ip_address'">tests/whitebox/test_payment_utils_additional.py:204: in test_create_payment_information_with_checkout
    result = create_payment_information(
E   TypeError: create_payment_information() got an unexpected keyword argument 'customer_ip_address'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreatePaymentInformation" name="test_create_payment_information_with_order" time="0.009"><failure message="TypeError: create_payment_information() got an unexpected keyword argument 'customer_ip_address'">tests/whitebox/test_payment_utils_additional.py:232: in test_create_payment_information_with_order
    result = create_payment_information(
E   TypeError: create_payment_information() got an unexpected keyword argument 'customer_ip_address'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreatePayment" name="test_create_payment_basic" time="0.006"><failure message="TypeError: create_payment() got an unexpected keyword argument 'payment_method_info'">tests/whitebox/test_payment_utils_additional.py:264: in test_create_payment_basic
    result = create_payment(
E   TypeError: create_payment() got an unexpected keyword argument 'payment_method_info'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreatePayment" name="test_create_payment_with_checkout" time="0.007"><failure message="TypeError: create_payment() got an unexpected keyword argument 'payment_method_info'">tests/whitebox/test_payment_utils_additional.py:297: in test_create_payment_with_checkout
    result = create_payment(
E   TypeError: create_payment() got an unexpected keyword argument 'payment_method_info'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_additional.TestCreatePayment" name="test_create_payment_with_order" time="0.008"><failure message="TypeError: create_payment() got an unexpected keyword argument 'payment_method_info'">tests/whitebox/test_payment_utils_additional.py:329: in test_create_payment_with_order
    result = create_payment(
E   TypeError: create_payment() got an unexpected keyword argument 'payment_method_info'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_comprehensive.TestPaymentModels" name="test_payment_captured_amount" time="0.006"><failure message="TypeError: Payment() got unexpected keyword arguments: 'channel'">tests/whitebox/test_payment_utils_comprehensive.py:38: in test_payment_captured_amount
    payment = Payment.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Payment() got unexpected keyword arguments: 'channel'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_comprehensive.TestPaymentModels" name="test_payment_get_authorized" time="0.005"><failure message="TypeError: Payment() got unexpected keyword arguments: 'channel'">tests/whitebox/test_payment_utils_comprehensive.py:55: in test_payment_get_authorized
    payment = Payment.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: Payment() got unexpected keyword arguments: 'channel'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_comprehensive.TestTransactionItem" name="test_transaction_item_authorized_amount" time="0.006"><failure message="TypeError: TransactionItem() got unexpected keyword arguments: 'channel'">tests/whitebox/test_payment_utils_comprehensive.py:77: in test_transaction_item_authorized_amount
    transaction = TransactionItem.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: TransactionItem() got unexpected keyword arguments: 'channel'</failure></testcase><testcase classname="tests.whitebox.test_payment_utils_comprehensive.TestTransactionItem" name="test_transaction_item_charged_amount" time="0.005"><failure message="TypeError: TransactionItem() got unexpected keyword arguments: 'channel'">tests/whitebox/test_payment_utils_comprehensive.py:92: in test_transaction_item_charged_amount
    transaction = TransactionItem.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: TransactionItem() got unexpected keyword arguments: 'channel'</failure></testcase><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestGetTotalDiscount" name="test_get_total_discount_undiscounted_greater" time="0.004" /><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestGetTotalDiscount" name="test_get_total_discount_undiscounted_equal" time="0.003" /><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestGetTotalDiscount" name="test_get_total_discount_undiscounted_less" time="0.003" /><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestGetTotalDiscountFromRange" name="test_get_total_discount_from_range" time="0.004" /><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestGetProductPriceRange" name="test_get_product_price_range_price_field" time="0.015" /><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestGetProductPriceRange" name="test_get_product_price_range_discounted_price_field" time="0.013" /><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestGetProductPriceRange" name="test_get_product_price_range_prior_price_field" time="0.014" /><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestGetProductPriceRange" name="test_get_product_price_range_none_prices" time="0.012" /><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestCalculateProductPriceWithTaxes" name="test_calculate_product_price_with_taxes_flat_rates" time="0.004" /><testcase classname="tests.whitebox.test_product_availability_comprehensive.TestCalculateProductPriceWithTaxes" name="test_calculate_product_price_with_taxes_other_strategy" time="0.003" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetTotalDiscount" name="test_get_total_discount_undiscounted_greater" time="0.004" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetTotalDiscount" name="test_get_total_discount_undiscounted_equal" time="0.003" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetTotalDiscount" name="test_get_total_discount_undiscounted_less" time="0.003" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetTotalDiscountFromRange" name="test_get_total_discount_from_range_calculates_correctly" time="0.004" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetProductPriceRange" name="test_get_product_price_range_with_prices" time="0.010"><failure message="django.db.utils.IntegrityError: duplicate key value violates unique constraint &quot;product_producttype_slug_key&quot;&#10;DETAIL:  Key (slug)=() already exists.">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.UniqueViolation: duplicate key value violates unique constraint "product_producttype_slug_key"
E   DETAIL:  Key (slug)=() already exists.

The above exception was the direct cause of the following exception:
tests/whitebox/test_product_availability_utils_comprehensive.py:132: in test_get_product_price_range_with_prices
    product_type=ProductType.objects.create(name="Type"),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: duplicate key value violates unique constraint "product_producttype_slug_key"
E   DETAIL:  Key (slug)=() already exists.</failure></testcase><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetProductPriceRange" name="test_get_product_price_range_with_none_prices" time="0.012" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetProductPriceRange" name="test_get_product_price_range_empty_list" time="0.004" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestCalculateProductPriceWithTaxes" name="test_calculate_product_price_with_taxes_flat_rates" time="0.004" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestCalculateProductPriceWithTaxes" name="test_calculate_product_price_with_taxes_other_strategy" time="0.003" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestCalculateProductPriceWithTaxesRange" name="test_calculate_product_price_with_taxes_range_with_prices" time="0.013" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestCalculateProductPriceWithTaxesRange" name="test_calculate_product_price_with_taxes_range_no_prices" time="0.013" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetProductAvailability" name="test_get_product_availability_with_discounts" time="0.015"><failure message="AssertionError: assert False is True&#10; +  where False = ProductAvailability(on_sale=False, price_range=TaxedMoneyRange(TaxedMoney(net=Money('7.984031936127744510978043912', 'USD'), gross=Money('8.00', 'USD')), TaxedMoney(net=Money('7.984031936127744510978043912', 'USD'), gross=Money('8.00', 'USD'))), price_range_undiscounted=TaxedMoneyRange(TaxedMoney(net=Money('9.980039920159680638722554890', 'USD'), gross=Money('10.00', 'USD')), TaxedMoney(net=Money('9.980039920159680638722554890', 'USD'), gross=Money('10.00', 'USD'))), price_range_prior=TaxedMoneyRange(TaxedMoney(net=Money('11.97604790419161676646706587', 'USD'), gross=Money('12.00', 'USD')), TaxedMoney(net=Money('11.97604790419161676646706587', 'USD'), gross=Money('12.00', 'USD'))), discount=TaxedMoney(net=Money('1.996007984031936127744510978', 'USD'), gross=Money('2.00', 'USD')), discount_prior=TaxedMoney(net=Money('3.992015968063872255489021958', 'USD'), gross=Money('4.00', 'USD'))).on_sale">tests/whitebox/test_product_availability_utils_comprehensive.py:335: in test_get_product_availability_with_discounts
    assert result.on_sale is True
E   AssertionError: assert False is True
E    +  where False = ProductAvailability(on_sale=False, price_range=TaxedMoneyRange(TaxedMoney(net=Money('7.984031936127744510978043912', 'USD'), gross=Money('8.00', 'USD')), TaxedMoney(net=Money('7.984031936127744510978043912', 'USD'), gross=Money('8.00', 'USD'))), price_range_undiscounted=TaxedMoneyRange(TaxedMoney(net=Money('9.980039920159680638722554890', 'USD'), gross=Money('10.00', 'USD')), TaxedMoney(net=Money('9.980039920159680638722554890', 'USD'), gross=Money('10.00', 'USD'))), price_range_prior=TaxedMoneyRange(TaxedMoney(net=Money('11.97604790419161676646706587', 'USD'), gross=Money('12.00', 'USD')), TaxedMoney(net=Money('11.97604790419161676646706587', 'USD'), gross=Money('12.00', 'USD'))), discount=TaxedMoney(net=Money('1.996007984031936127744510978', 'USD'), gross=Money('2.00', 'USD')), discount_prior=TaxedMoney(net=Money('3.992015968063872255489021958', 'USD'), gross=Money('4.00', 'USD'))).on_sale</failure></testcase><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetProductAvailability" name="test_get_product_availability_no_undiscounted" time="0.012" /><testcase classname="tests.whitebox.test_product_availability_utils_comprehensive.TestGetVariantAvailability" name="test_get_variant_availability_calculates_correctly" time="0.012"><failure message="TypeError: get_variant_availability() missing 1 required keyword-only argument: 'product_channel_listing'">tests/whitebox/test_product_availability_utils_comprehensive.py:404: in test_get_variant_availability_calculates_correctly
    result = get_variant_availability(
E   TypeError: get_variant_availability() missing 1 required keyword-only argument: 'product_channel_listing'</failure></testcase><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetBasePrice" name="test_get_base_price_price_override_none" time="0.011" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetBasePrice" name="test_get_base_price_price_override_provided" time="0.011" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetBasePriceDecision" name="test_decision_price_override_none_true" time="0.011" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetBasePriceDecision" name="test_decision_price_override_none_false" time="0.011" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPrice" name="test_get_price_price_override_none_with_discounted_price" time="0.011" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPrice" name="test_get_price_price_override_none_without_discounted_price" time="0.011" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPrice" name="test_get_price_price_override_provided" time="0.011" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPriceDecision" name="test_decision_price_override_none_true" time="0.011" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPriceDecision" name="test_decision_price_override_none_false" time="0.012" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPriceDecision" name="test_decision_discounted_price_exists_true" time="0.012" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPriceDecision" name="test_decision_discounted_price_exists_false" time="0.012" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPriorPriceAmount" name="test_get_prior_price_channel_listing_none" time="0.010" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPriorPriceAmount" name="test_get_prior_price_prior_price_none" time="0.012" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetPriorPriceAmount" name="test_get_prior_price_with_prior_price" time="0.012" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetWeight" name="test_get_weight_variant_weight_exists" time="0.010" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetWeight" name="test_get_weight_product_weight_exists" time="0.009" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantGetWeight" name="test_get_weight_product_type_weight_exists" time="0.010" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantIsDigital" name="test_is_digital_shipping_required_false_and_is_digital_true" time="0.010" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantIsDigital" name="test_is_digital_shipping_required_true" time="0.010" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantIsDigital" name="test_is_digital_is_digital_false" time="0.010" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantIsDigitalMCDC" name="test_mcdc_not_shipping_required_true_is_digital_true" time="0.009" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantIsDigitalMCDC" name="test_mcdc_not_shipping_required_false" time="0.009" /><testcase classname="tests.whitebox.test_product_models.TestProductVariantIsDigitalMCDC" name="test_mcdc_is_digital_false" time="0.009" /><testcase classname="tests.whitebox.test_product_utils.TestProductAvailability" name="test_get_product_availability_in_stock" time="0.011"><failure message="TypeError: get_product_availability() got an unexpected keyword argument 'product'">tests/whitebox/test_product_utils.py:48: in test_get_product_availability_in_stock
    availability = get_product_availability(
E   TypeError: get_product_availability() got an unexpected keyword argument 'product'</failure></testcase><testcase classname="tests.whitebox.test_product_utils.TestProductAvailability" name="test_get_product_availability_out_of_stock" time="0.010"><failure message="TypeError: get_product_availability() got an unexpected keyword argument 'product'">tests/whitebox/test_product_utils.py:79: in test_get_product_availability_out_of_stock
    availability = get_product_availability(
E   TypeError: get_product_availability() got an unexpected keyword argument 'product'</failure></testcase><testcase classname="tests.whitebox.test_product_utils.TestVariantSelectionAttributes" name="test_get_variant_selection_attributes" time="0.011"><failure message="TypeError: 'ProductVariant' object is not iterable">tests/whitebox/test_product_utils.py:112: in test_get_variant_selection_attributes
    attributes = get_variant_selection_attributes(variant)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/product/utils/variants.py:49: in get_variant_selection_attributes
    return [
E   TypeError: 'ProductVariant' object is not iterable</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils.TestShippingModels" name="test_shipping_zone_creation" time="0.005" /><testcase classname="tests.whitebox.test_shipping_utils.TestShippingModels" name="test_shipping_method_creation" time="0.005" /><testcase classname="tests.whitebox.test_shipping_utils.TestShippingModels" name="test_shipping_method_channel_listing" time="0.007" /><testcase classname="tests.whitebox.test_shipping_utils.TestShippingModels" name="test_shipping_method_minimum_order_price" time="0.006"><failure message="TypeError: ShippingMethod() got unexpected keyword arguments: 'minimum_order_price_amount'">tests/whitebox/test_shipping_utils.py:95: in test_shipping_method_minimum_order_price
    method = ShippingMethod.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: ShippingMethod() got unexpected keyword arguments: 'minimum_order_price_amount'</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils.TestShippingModels" name="test_shipping_method_maximum_order_price" time="0.006"><failure message="TypeError: ShippingMethod() got unexpected keyword arguments: 'maximum_order_price_amount'">tests/whitebox/test_shipping_utils.py:125: in test_shipping_method_maximum_order_price
    method = ShippingMethod.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:569: in __init__
    raise TypeError(
E   TypeError: ShippingMethod() got unexpected keyword arguments: 'maximum_order_price_amount'</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestDefaultShippingZoneExists" name="test_default_shipping_zone_exists_returns_queryset_when_zone_exists" time="0.007" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestDefaultShippingZoneExists" name="test_default_shipping_zone_exists_returns_empty_when_no_default" time="0.006" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestDefaultShippingZoneExists" name="test_default_shipping_zone_exists_excludes_specified_pk" time="0.007" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestGetCountriesWithoutShippingZone" name="test_get_countries_without_shipping_zone_returns_uncovered_countries" time="0.014" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestGetCountriesWithoutShippingZone" name="test_get_countries_without_shipping_zone_returns_all_when_no_zones" time="0.012"><failure message="AssertionError: assert 'US' in ['AF', 'AX', 'AL', 'DZ', 'AS', 'AD', ...]">tests/whitebox/test_shipping_utils_comprehensive.py:104: in test_get_countries_without_shipping_zone_returns_all_when_no_zones
    assert "US" in uncovered
E   AssertionError: assert 'US' in ['AF', 'AX', 'AL', 'DZ', 'AS', 'AD', ...]</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestGetCountriesWithoutShippingZone" name="test_get_countries_without_shipping_zone_handles_multiple_countries_in_zone" time="0.013" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertToShippingMethodData" name="test_convert_to_shipping_method_data_with_tax_class" time="0.009" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertToShippingMethodData" name="test_convert_to_shipping_method_data_without_tax_class" time="0.008" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertToShippingMethodData" name="test_convert_to_shipping_method_data_with_weight_based_method" time="0.008" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertToShippingMethodData" name="test_convert_to_shipping_method_data_with_metadata" time="0.007" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertToShippingMethodData" name="test_convert_to_shipping_method_data_with_delivery_days" time="0.008" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertCheckoutDeliveryToShippingMethodData" name="test_convert_checkout_delivery_to_shipping_method_data" time="0.008"><failure message="AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter">tests/whitebox/test_shipping_utils_comprehensive.py:301: in test_convert_checkout_delivery_to_shipping_method_data
    delivery = CheckoutDelivery.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertCheckoutDeliveryToShippingMethodData" name="test_convert_checkout_delivery_with_message" time="0.007"><failure message="AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter">tests/whitebox/test_shipping_utils_comprehensive.py:346: in test_convert_checkout_delivery_with_message
    delivery = CheckoutDelivery.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertCheckoutDeliveryToShippingMethodData" name="test_convert_checkout_delivery_with_inactive_status" time="0.007"><failure message="AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter">tests/whitebox/test_shipping_utils_comprehensive.py:370: in test_convert_checkout_delivery_with_inactive_status
    delivery = CheckoutDelivery.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertCheckoutDeliveryToShippingMethodData" name="test_convert_checkout_delivery_with_invalid_status" time="0.007"><failure message="AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter">tests/whitebox/test_shipping_utils_comprehensive.py:395: in test_convert_checkout_delivery_with_invalid_status
    delivery = CheckoutDelivery.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertCheckoutDeliveryToShippingMethodData" name="test_convert_checkout_delivery_with_empty_message" time="0.007"><failure message="AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter">tests/whitebox/test_shipping_utils_comprehensive.py:420: in test_convert_checkout_delivery_with_empty_message
    delivery = CheckoutDelivery.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:663: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/base.py:558: in __init__
    _setattr(self, prop, value)
E   AttributeError: property 'shipping_method_id' of 'CheckoutDelivery' object has no setter</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertShippingMethodDataToCheckoutDelivery" name="test_convert_shipping_method_data_to_checkout_delivery_built_in" time="0.007"><failure message="TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'">tests/whitebox/test_shipping_utils_comprehensive.py:450: in test_convert_shipping_method_data_to_checkout_delivery_built_in
    shipping_data = ShippingMethodData(
E   TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertShippingMethodDataToCheckoutDelivery" name="test_convert_shipping_method_data_to_checkout_delivery_external" time="0.007"><failure message="TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'">tests/whitebox/test_shipping_utils_comprehensive.py:497: in test_convert_shipping_method_data_to_checkout_delivery_external
    shipping_data = ShippingMethodData(
E   TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertShippingMethodDataToCheckoutDelivery" name="test_convert_shipping_method_data_to_checkout_delivery_without_tax_class" time="0.007"><failure message="TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'">tests/whitebox/test_shipping_utils_comprehensive.py:522: in test_convert_shipping_method_data_to_checkout_delivery_without_tax_class
    shipping_data = ShippingMethodData(
E   TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertShippingMethodDataToCheckoutDelivery" name="test_convert_shipping_method_data_to_checkout_delivery_with_message" time="0.007"><failure message="TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'">tests/whitebox/test_shipping_utils_comprehensive.py:547: in test_convert_shipping_method_data_to_checkout_delivery_with_message
    shipping_data = ShippingMethodData(
E   TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestConvertShippingMethodDataToCheckoutDelivery" name="test_convert_shipping_method_data_to_checkout_delivery_with_empty_name" time="0.007"><failure message="TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'">tests/whitebox/test_shipping_utils_comprehensive.py:571: in test_convert_shipping_method_data_to_checkout_delivery_with_empty_name
    shipping_data = ShippingMethodData(
E   TypeError: ShippingMethodData.__init__() got an unexpected keyword argument 'is_external'</failure></testcase><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestInitializeShippingMethodActiveStatus" name="test_initialize_shipping_method_active_status_all_active" time="0.004" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestInitializeShippingMethodActiveStatus" name="test_initialize_shipping_method_active_status_with_exclusions" time="0.004" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestInitializeShippingMethodActiveStatus" name="test_initialize_shipping_method_active_status_partial_exclusions" time="0.004" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestInitializeShippingMethodActiveStatus" name="test_initialize_shipping_method_active_status_resets_existing_status" time="0.004" /><testcase classname="tests.whitebox.test_shipping_utils_comprehensive.TestInitializeShippingMethodActiveStatus" name="test_initialize_shipping_method_active_status_empty_list" time="0.004" /><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestGetAvailableQuantity" name="test_get_available_quantity_without_reservations" time="0.005"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (ac4f156b-624b-4139-a946-1daecc720370, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (ac4f156b-624b-4139-a946-1daecc720370, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_availability_comprehensive.py:35: in test_get_available_quantity_without_reservations
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (ac4f156b-624b-4139-a946-1daecc720370, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestGetAvailableQuantity" name="test_get_available_quantity_with_reservations" time="0.004"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (b0ebf78f-18f9-46b1-b03c-18de481e22fd, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (b0ebf78f-18f9-46b1-b03c-18de481e22fd, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_availability_comprehensive.py:60: in test_get_available_quantity_with_reservations
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (b0ebf78f-18f9-46b1-b03c-18de481e22fd, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestGetAvailableQuantity" name="test_get_available_quantity_returns_zero_if_negative" time="0.004"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (6fe8333f-5924-4c50-9038-9ff1f9448188, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (6fe8333f-5924-4c50-9038-9ff1f9448188, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_availability_comprehensive.py:86: in test_get_available_quantity_returns_zero_if_negative
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (6fe8333f-5924-4c50-9038-9ff1f9448188, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestCheckStockAndPreorderQuantity" name="test_check_stock_and_preorder_quantity_preorder_active" time="0.012" /><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestCheckStockAndPreorderQuantity" name="test_check_stock_and_preorder_quantity_not_preorder" time="0.011" /><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestCheckStockQuantity" name="test_check_stock_quantity_sufficient_stock" time="0.005"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (bc450862-80ee-4cc8-b819-776c738cada4, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (bc450862-80ee-4cc8-b819-776c738cada4, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_availability_comprehensive.py:171: in test_check_stock_quantity_sufficient_stock
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (bc450862-80ee-4cc8-b819-776c738cada4, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestCheckStockQuantity" name="test_check_stock_quantity_insufficient_stock" time="0.005"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (222d8464-5b03-4a6c-9e65-04028215d300, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (222d8464-5b03-4a6c-9e65-04028215d300, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_availability_comprehensive.py:201: in test_check_stock_quantity_insufficient_stock
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (222d8464-5b03-4a6c-9e65-04028215d300, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestGetAvailableQuantityFunction" name="test_get_available_quantity_returns_correct_value" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (1f806eb7-8e4e-4b19-906e-459e1a768df7, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (1f806eb7-8e4e-4b19-906e-459e1a768df7, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_availability_comprehensive.py:236: in test_get_available_quantity_returns_correct_value
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (1f806eb7-8e4e-4b19-906e-459e1a768df7, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestIsProductInStock" name="test_is_product_in_stock_has_stock" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (0a867d7e-ecd7-4eb7-affe-dedcf20972f6, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (0a867d7e-ecd7-4eb7-affe-dedcf20972f6, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_availability_comprehensive.py:268: in test_is_product_in_stock_has_stock
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (0a867d7e-ecd7-4eb7-affe-dedcf20972f6, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_availability_comprehensive.TestIsProductInStock" name="test_is_product_in_stock_no_stock" time="0.025" /><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestGetOrderLinesWithTrackInventory" name="test_get_order_lines_with_track_inventory_tracks_inventory" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:27:03.049064+00, , , 74fe5649-0c72-49d8-a314-55d547ad8f57, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 303, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:27:03.049699+00, f, 123, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:27:03.049064+00, , , 74fe5649-0c72-49d8-a314-55d547ad8f57, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 303, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:27:03.049699+00, f, 123, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:47: in test_get_order_lines_with_track_inventory_tracks_inventory
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:27:03.049064+00, , , 74fe5649-0c72-49d8-a314-55d547ad8f57, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 303, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:27:03.049699+00, f, 123, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestGetOrderLinesWithTrackInventory" name="test_get_order_lines_with_track_inventory_no_track" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:27:03.461347+00, , , 722c912b-e9e8-43e4-87af-5429bc7e0423, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 304, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:27:03.462012+00, f, 124, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:27:03.461347+00, , , 722c912b-e9e8-43e4-87af-5429bc7e0423, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 304, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:27:03.462012+00, f, 124, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:83: in test_get_order_lines_with_track_inventory_no_track
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:27:03.461347+00, , , 722c912b-e9e8-43e4-87af-5429bc7e0423, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 304, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:27:03.462012+00, f, 124, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestGetOrderLinesWithTrackInventory" name="test_get_order_lines_with_track_inventory_no_variant" time="0.007"><failure message="django.db.utils.IntegrityError: null value in column &quot;lines_count&quot; of relation &quot;order_order&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2025-12-07 13:27:04.093215+00, , , 92ff8df9-ab43-4dd5-9a12-50ebcf2047db, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 305, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:27:04.093991+00, f, 125, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:27:04.093215+00, , , 92ff8df9-ab43-4dd5-9a12-50ebcf2047db, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 305, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:27:04.093991+00, f, 125, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:118: in test_get_order_lines_with_track_inventory_no_variant
    order = Order.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "lines_count" of relation "order_order" violates not-null constraint
E   DETAIL:  Failing row contains (2025-12-07 13:27:04.093215+00, , , 92ff8df9-ab43-4dd5-9a12-50ebcf2047db, null, null, null, 0.000, null, en, 0.000, 0.000, 0.000, unfulfilled, null, null, t, , 0, , USD, {}, {}, 305, null, null, 0.000, 0.000, 0.000, , null, null, , 2025-12-07 13:27:04.093991+00, f, 125, null, 0.000, none, none, null, t, f, 0.000, null, {}, null, {}, null, null, null, 0.000, 0.000, null, 0.000, null, null, null, {}, {}).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestIncreaseStock" name="test_increase_stock_creates_stock_if_not_exists" time="0.004"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (e987ab00-dd78-40a8-af31-e681ef7e1df6, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (e987ab00-dd78-40a8-af31-e681ef7e1df6, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:145: in test_increase_stock_creates_stock_if_not_exists
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (e987ab00-dd78-40a8-af31-e681ef7e1df6, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestIncreaseStock" name="test_increase_stock_increases_existing_stock" time="0.004"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (18181a73-8d7b-4df2-ac76-cd826d4deb9b, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (18181a73-8d7b-4df2-ac76-cd826d4deb9b, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:164: in test_increase_stock_increases_existing_stock
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (18181a73-8d7b-4df2-ac76-cd826d4deb9b, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestIncreaseStock" name="test_increase_stock_with_allocate" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (68fdd25a-6620-4eb5-9cf0-e1b7666f3a74, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (68fdd25a-6620-4eb5-9cf0-e1b7666f3a74, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:193: in test_increase_stock_with_allocate
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (68fdd25a-6620-4eb5-9cf0-e1b7666f3a74, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestDecreaseStock" name="test_decrease_stock_decreases_quantity" time="0.004"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (225848ae-9a02-4aef-87cd-43c8e554255f, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (225848ae-9a02-4aef-87cd-43c8e554255f, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:230: in test_decrease_stock_decreases_quantity
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (225848ae-9a02-4aef-87cd-43c8e554255f, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestIncreaseAllocations" name="test_increase_allocations_creates_allocation" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (e3765315-bc7e-452b-bbae-0df579b1cf5c, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (e3765315-bc7e-452b-bbae-0df579b1cf5c, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:264: in test_increase_allocations_creates_allocation
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (e3765315-bc7e-452b-bbae-0df579b1cf5c, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestIncreaseAllocations" name="test_increase_allocations_increases_existing_allocation" time="0.005"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (8bbcd48f-ff06-4e8d-a5f2-84b9d982e525, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (8bbcd48f-ff06-4e8d-a5f2-84b9d982e525, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:312: in test_increase_allocations_increases_existing_allocation
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (8bbcd48f-ff06-4e8d-a5f2-84b9d982e525, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestDecreaseAllocations" name="test_decrease_allocations_decreases_quantity" time="0.005"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (868272cb-dddc-4f64-8795-fcf6988733a3, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (868272cb-dddc-4f64-8795-fcf6988733a3, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:369: in test_decrease_allocations_decreases_quantity
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (868272cb-dddc-4f64-8795-fcf6988733a3, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestDecreaseAllocations" name="test_decrease_allocations_deletes_allocation_when_zero" time="0.005"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (240d700f-efcc-4ff4-81a6-13c95c03c523, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (240d700f-efcc-4ff4-81a6-13c95c03c523, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:421: in test_decrease_allocations_deletes_allocation_when_zero
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (240d700f-efcc-4ff4-81a6-13c95c03c523, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_comprehensive.TestDeallocateStock" name="test_deallocate_stock_deallocates_for_lines" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (7c637d73-15c8-4c98-932e-61a82ba4c64c, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (7c637d73-15c8-4c98-932e-61a82ba4c64c, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_comprehensive.py:478: in test_deallocate_stock_deallocates_for_lines
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (7c637d73-15c8-4c98-932e-61a82ba4c64c, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestDeleteStocks" name="test_delete_stocks_deletes_specified_stocks" time="0.004"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (c334a141-41c9-4beb-9229-aef05f2f14bc, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (c334a141-41c9-4beb-9229-aef05f2f14bc, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:40: in test_delete_stocks_deletes_specified_stocks
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (c334a141-41c9-4beb-9229-aef05f2f14bc, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestStockBulkUpdate" name="test_stock_bulk_update_updates_stocks" time="0.004"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (25390c2c-137c-4d17-a312-534fe17c1bc0, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (25390c2c-137c-4d17-a312-534fe17c1bc0, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:76: in test_stock_bulk_update_updates_stocks
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (25390c2c-137c-4d17-a312-534fe17c1bc0, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestDeleteAllocations" name="test_delete_allocations_deletes_specified_allocations" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (a1dd8bcd-604c-4b30-abee-2f103ce8ecc5, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (a1dd8bcd-604c-4b30-abee-2f103ce8ecc5, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:122: in test_delete_allocations_deletes_specified_allocations
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (a1dd8bcd-604c-4b30-abee-2f103ce8ecc5, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestIncreaseStock" name="test_increase_stock_increases_quantity" time="0.004"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (0a9a4251-e283-44d3-abd9-53c6931910a8, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (0a9a4251-e283-44d3-abd9-53c6931910a8, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:181: in test_increase_stock_increases_quantity
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (0a9a4251-e283-44d3-abd9-53c6931910a8, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestIncreaseStock" name="test_increase_stock_handles_multiple_stocks" time="0.004"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (2b8de9a4-7fee-41f0-b999-47d84ff1f0f0, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (2b8de9a4-7fee-41f0-b999-47d84ff1f0f0, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:207: in test_increase_stock_handles_multiple_stocks
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (2b8de9a4-7fee-41f0-b999-47d84ff1f0f0, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestIncreaseAllocations" name="test_increase_allocations_increases_quantity_allocated" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (06c010c0-2f64-4316-b7ff-788e8d111c78, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (06c010c0-2f64-4316-b7ff-788e8d111c78, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:250: in test_increase_allocations_increases_quantity_allocated
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (06c010c0-2f64-4316-b7ff-788e8d111c78, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestDecreaseAllocations" name="test_decrease_allocations_decreases_quantity_allocated" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (a493e0b7-ff5e-4276-9a72-c58a888f3fdd, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (a493e0b7-ff5e-4276-9a72-c58a888f3fdd, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:312: in test_decrease_allocations_decreases_quantity_allocated
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (a493e0b7-ff5e-4276-9a72-c58a888f3fdd, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestDecreaseStock" name="test_decrease_stock_decreases_quantity" time="0.005"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (8d6e34cd-1f0b-4f44-9e15-82a298f934a1, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (8d6e34cd-1f0b-4f44-9e15-82a298f934a1, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:381: in test_decrease_stock_decreases_quantity
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (8d6e34cd-1f0b-4f44-9e15-82a298f934a1, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestDecreaseStock" name="test_decrease_stock_raises_insufficient_stock_when_not_enough" time="0.005"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (b4bfdf14-018b-40a1-bf7f-98983947c3e2, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (b4bfdf14-018b-40a1-bf7f-98983947c3e2, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:437: in test_decrease_stock_raises_insufficient_stock_when_not_enough
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (b4bfdf14-018b-40a1-bf7f-98983947c3e2, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestDeallocateStock" name="test_deallocate_stock_deallocates_quantities" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (f3f911b5-5251-4682-9058-1c05bf60c1a1, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (f3f911b5-5251-4682-9058-1c05bf60c1a1, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:496: in test_deallocate_stock_deallocates_quantities
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (f3f911b5-5251-4682-9058-1c05bf60c1a1, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_warehouse_management_extensive.TestDeallocateStockForOrders" name="test_deallocate_stock_for_orders_deallocates_all_order_lines" time="0.006"><failure message="django.db.utils.IntegrityError: null value in column &quot;address_id&quot; of relation &quot;warehouse_warehouse&quot; violates not-null constraint&#10;DETAIL:  Failing row contains (4190340d-2ac0-4048-9492-9450f0df5fdf, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).">.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   psycopg.errors.NotNullViolation: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (4190340d-2ac0-4048-9492-9450f0df5fdf, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).

The above exception was the direct cause of the following exception:
tests/whitebox/test_warehouse_management_extensive.py:565: in test_deallocate_stock_for_orders_deallocates_all_order_lines
    warehouse = Warehouse.objects.create(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:665: in create
    obj.save(force_insert=True, using=self.db)
.venv/lib/python3.12/site-packages/django/db/models/base.py:902: in save
    self.save_base(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1008: in save_base
    updated = self._save_table(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1169: in _save_table
    results = self._do_insert(
.venv/lib/python3.12/site-packages/django/db/models/base.py:1210: in _do_insert
    return manager._insert(
.venv/lib/python3.12/site-packages/django/db/models/manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:1873: in _insert
    return query.get_compiler(using=using).execute_sql(returning_fields)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1882: in execute_sql
    cursor.execute(sql, params)
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:79: in execute
    return self._execute_with_wrappers(
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:92: in _execute_with_wrappers
    return executor(sql, params, many, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:100: in _execute
    with self.db.wrap_database_errors:
.venv/lib/python3.12/site-packages/django/db/utils.py:91: in __exit__
    raise dj_exc_value.with_traceback(traceback) from exc_value
.venv/lib/python3.12/site-packages/django/db/backends/utils.py:105: in _execute
    return self.cursor.execute(sql, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/psycopg/cursor.py:117: in execute
    raise ex.with_traceback(None)
E   django.db.utils.IntegrityError: null value in column "address_id" of relation "warehouse_warehouse" violates not-null constraint
E   DETAIL:  Failing row contains (4190340d-2ac0-4048-9492-9450f0df5fdf, Test Warehouse, , null, test-warehouse, {}, {}, disabled, t, null).</failure></testcase><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_event_type_async" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_event_type_sync" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_apps_ids" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_apps_identifier" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_app_deleted_event" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEvent" name="test_get_filter_without_permissions" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetWebhooksForEvent" name="test_get_webhooks_without_webhooks_param" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetWebhooksForEvent" name="test_get_webhooks_with_webhooks_param" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetWebhooksForEvent" name="test_get_webhooks_with_apps_ids" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetWebhooksForEvent" name="test_get_webhooks_with_apps_identifier" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetWebhooksForMultipleEvents" name="test_get_webhooks_for_single_event" time="0.004"><failure message="django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.">tests/whitebox/test_webhook_utils.py:107: in test_get_webhooks_for_single_event
    result = get_webhooks_for_multiple_events(event_types)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/webhook/utils.py:97: in get_webhooks_for_multiple_events
    for webhook_id, event_type in webhook_id_to_event_type:
.venv/lib/python3.12/site-packages/django/db/models/query.py:386: in __iter__
    self._fetch_all()
.venv/lib/python3.12/site-packages/django/db/models/query.py:1954: in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:234: in __iter__
    return compiler.results_iter(
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1572: in results_iter
    results = self.execute_sql(
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1621: in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/test/testcases.py:201: in __call__
    raise DatabaseOperationForbidden(self.message)
E   django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.</failure></testcase><testcase classname="tests.whitebox.test_webhook_utils.TestGetWebhooksForMultipleEvents" name="test_get_webhooks_for_multiple_events" time="0.005"><failure message="django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.">tests/whitebox/test_webhook_utils.py:116: in test_get_webhooks_for_multiple_events
    result = get_webhooks_for_multiple_events(event_types)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/webhook/utils.py:97: in get_webhooks_for_multiple_events
    for webhook_id, event_type in webhook_id_to_event_type:
.venv/lib/python3.12/site-packages/django/db/models/query.py:386: in __iter__
    self._fetch_all()
.venv/lib/python3.12/site-packages/django/db/models/query.py:1954: in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:234: in __iter__
    return compiler.results_iter(
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1572: in results_iter
    results = self.execute_sql(
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1621: in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/test/testcases.py:201: in __call__
    raise DatabaseOperationForbidden(self.message)
E   django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.</failure></testcase><testcase classname="tests.whitebox.test_webhook_utils.TestGetWebhooksForMultipleEvents" name="test_get_webhooks_with_async_event_adds_any" time="0.005"><failure message="django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.">tests/whitebox/test_webhook_utils.py:122: in test_get_webhooks_with_async_event_adds_any
    result = get_webhooks_for_multiple_events(event_types)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
saleor/webhook/utils.py:97: in get_webhooks_for_multiple_events
    for webhook_id, event_type in webhook_id_to_event_type:
.venv/lib/python3.12/site-packages/django/db/models/query.py:386: in __iter__
    self._fetch_all()
.venv/lib/python3.12/site-packages/django/db/models/query.py:1954: in _fetch_all
    self._result_cache = list(self._iterable_class(self))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/db/models/query.py:234: in __iter__
    return compiler.results_iter(
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1572: in results_iter
    results = self.execute_sql(
.venv/lib/python3.12/site-packages/django/db/models/sql/compiler.py:1621: in execute_sql
    cursor = self.connection.cursor()
             ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/django/test/testcases.py:201: in __call__
    raise DatabaseOperationForbidden(self.message)
E   django.test.testcases.DatabaseOperationForbidden: Database queries to 'replica' are not allowed in this test. Add 'replica' to pytest_django.fixtures._django_db_helper.&lt;locals&gt;.PytestDjangoTestCase.databases to ensure proper test isolation and silence this failure.</failure></testcase><testcase classname="tests.whitebox.test_webhook_utils.TestGetWebhooksForMultipleEvents" name="test_get_webhooks_with_empty_list" time="0.007" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEventDecisionCoverage" name="test_decision_with_permissions" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEventDecisionCoverage" name="test_decision_without_permissions" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEventDecisionCoverage" name="test_decision_app_deleted_vs_other" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEventDecisionCoverage" name="test_decision_with_apps_ids" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils.TestGetFilterForSingleWebhookEventDecisionCoverage" name="test_decision_with_apps_identifier" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_event_type_async" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_event_type_sync" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_apps_ids" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_apps_identifier" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_both_apps_ids_and_identifier" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetFilterForSingleWebhookEvent" name="test_get_filter_with_app_deleted_event" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetFilterForSingleWebhookEvent" name="test_get_filter_without_permissions" time="0.005" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetWebhooksForEvent" name="test_get_webhooks_for_event_with_webhooks_queryset" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetWebhooksForEvent" name="test_get_webhooks_for_event_without_webhooks" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetWebhooksForEvent" name="test_get_webhooks_for_event_with_apps_ids" time="0.006" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetWebhooksForEvent" name="test_get_webhooks_for_event_with_apps_identifier" time="0.007" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetWebhooksForMultipleEvents" name="test_get_webhooks_for_multiple_events_empty" time="0.007" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetWebhooksForMultipleEvents" name="test_get_webhooks_for_multiple_events_single" time="0.008" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetWebhooksForMultipleEvents" name="test_get_webhooks_for_multiple_events_multiple" time="0.007" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetWebhooksForMultipleEvents" name="test_get_webhooks_for_multiple_events_with_any" time="0.007" /><testcase classname="tests.whitebox.test_webhook_utils_comprehensive.TestGetWebhooksForMultipleEvents" name="test_get_webhooks_for_multiple_events_with_sync_events" time="0.007" /><testcase classname="tests.integration.test_api" name="test_graphql_products_query" time="0.013" /><testcase classname="tests.integration.test_api" name="test_static_files" time="0.003" /><testcase classname="tests.test_basic" name="test_health" time="0.003" /><testcase classname="tests.test_basic" name="test_graphql" time="0.139" /></testsuite></testsuites>